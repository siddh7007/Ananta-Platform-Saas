# RabbitMQ Configuration for Components Platform V2
# Port: 27250 (AMQP), 27251 (Management UI)

# ==============================================================================
# CORE SETTINGS
# ==============================================================================

# Listeners
listeners.tcp.default = 5672

# Management Plugin
management.tcp.port = 15672
management.tcp.ip = 0.0.0.0

# Virtual Host
default_vhost = components-v2
default_user = admin
default_pass = admin123_change_in_production

# Permissions (admin user gets full access)
default_permissions.configure = .*
default_permissions.write = .*
default_permissions.read = .*

# ==============================================================================
# PERFORMANCE & LIMITS
# ==============================================================================

# Memory
vm_memory_high_watermark.relative = 0.6
vm_memory_high_watermark_paging_ratio = 0.75

# Disk Free Space
disk_free_limit.absolute = 2GB

# Message Size
max_message_size = 134217728

# ==============================================================================
# CLUSTERING (Single Node for Now)
# ==============================================================================

cluster_formation.peer_discovery_backend = rabbit_peer_discovery_classic_config
cluster_formation.classic_config.nodes.1 = rabbit@rabbitmq

# ==============================================================================
# LOGGING
# ==============================================================================

log.file.level = info
log.console.level = warning
log.console = true
log.file = /var/log/rabbitmq/rabbit.log

# Connection logging (reduced verbosity)
log.connection.level = error

# ==============================================================================
# SECURITY
# ==============================================================================

# Disable guest user remote access (security)
loopback_users.guest = true

# TLS/SSL (disabled for development, enable in production)
# listeners.ssl.default = 5671
# ssl_options.cacertfile = /path/to/ca_certificate.pem
# ssl_options.certfile   = /path/to/server_certificate.pem
# ssl_options.keyfile    = /path/to/server_key.pem
# ssl_options.verify     = verify_peer
# ssl_options.fail_if_no_peer_cert = false

# ==============================================================================
# MANAGEMENT PLUGIN SETTINGS
# ==============================================================================

# CORS (for web UI access)
management.cors.allow_origins.1 = *
management.cors.max_age = 3600

# Rate Limiting (prevent abuse)
management.rates_mode = detailed

# HTTP API Compression
management.http_log_dir = /var/log/rabbitmq

# ==============================================================================
# QUEUE DEFAULTS
# ==============================================================================

# Default Queue Master Location
queue_master_locator = min-masters

# Message TTL (optional, disabled by default)
# default_message_ttl = 86400000

# Queue TTL (auto-delete unused queues after 30 days)
# queue_ttl = 2592000000

# ==============================================================================
# PLUGINS
# ==============================================================================

# Plugins are enabled via enabled_plugins file

# ==============================================================================
# FEDERATION & SHOVEL (Optional, for future multi-datacenter)
# ==============================================================================

# federation.upstream.example.uri = amqp://server-name
# federation.upstream.example.exchange = exchange-name

# ==============================================================================
# PROMETHEUS MONITORING (Optional)
# ==============================================================================

# prometheus.tcp.port = 15692
# prometheus.return_per_object_metrics = true
