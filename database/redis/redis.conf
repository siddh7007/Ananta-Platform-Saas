# Redis Configuration for Ananta Platform
# Port: 27012 (externally mapped to 6379 internal)
# Based on docker-compose.yml: redis:7-alpine with appendonly

# ==============================================================================
# PERSISTENCE
# ==============================================================================

# Enable AOF (Append Only File) persistence
appendonly yes
appendfilename "appendonly.aof"
appendfsync everysec

# RDB Snapshots (backup)
save 900 1
save 300 10
save 60 10000

# ==============================================================================
# MEMORY MANAGEMENT
# ==============================================================================

# Max memory (adjust based on environment)
# maxmemory 256mb

# Eviction policy when max memory is reached
maxmemory-policy volatile-lru

# ==============================================================================
# NETWORK
# ==============================================================================

# Listen on all interfaces (Kubernetes/Docker)
bind 0.0.0.0

# Default port
port 6379

# Disable protected mode for container networking
protected-mode no

# TCP keepalive
tcp-keepalive 300

# ==============================================================================
# PERFORMANCE
# ==============================================================================

# Hash optimization
hash-max-ziplist-entries 512
hash-max-ziplist-value 64

# List optimization
list-max-ziplist-size -2

# Set optimization
set-max-intset-entries 512

# ==============================================================================
# LOGGING
# ==============================================================================

# Log level (debug, verbose, notice, warning)
loglevel notice

# Log to stdout (container best practice)
logfile ""

# ==============================================================================
# SECURITY (Configure in production)
# ==============================================================================

# Require password (set via REDIS_PASSWORD env var or uncomment)
# requirepass your-strong-password-here

# Disable dangerous commands in production
# rename-command FLUSHALL ""
# rename-command FLUSHDB ""
# rename-command CONFIG ""
# rename-command DEBUG ""

# ==============================================================================
# REDIS DATABASES
# Used by different services:
# - DB 0: Default
# - DB 1: Django backend
# - DB 2: CNS Service
# - DB 3: Middleware API
# - DB 4: Directus
# ==============================================================================

databases 16
