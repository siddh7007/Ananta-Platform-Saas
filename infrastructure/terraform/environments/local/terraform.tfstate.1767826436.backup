{
  "version": 4,
  "terraform_version": "1.14.3",
  "serial": 55,
  "lineage": "30dd319f-3540-0a63-2b76-edc1d5e3294d",
  "outputs": {
    "admin_app_url": {
      "value": "http://admin-app.control-plane.svc.cluster.local",
      "type": "string"
    },
    "api_url": {
      "value": "http://tenant-management-service.control-plane.svc.cluster.local:14000",
      "type": "string"
    },
    "database_host": {
      "value": "ananta-local-pg-rw.database-system.svc.cluster.local",
      "type": "string"
    },
    "keycloak_url": {
      "value": "http://localhost:8180",
      "type": "string"
    },
    "temporal_ui_url": {
      "value": "http://localhost:27021",
      "type": "string"
    },
    "vault_address": {
      "value": "http://ananta-vault.vault-system.svc.cluster.local:8200",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "managed",
      "type": "kubernetes_config_map",
      "name": "app_plane_migrations",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "kubernetes_config_map",
      "name": "db_migrations",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "binary_data": {},
            "data": {
              "003_ARC_SAAS_MASTER.sql": "-- ============================================================================\n-- ULTIMATE MASTER MIGRATION: Arc-SaaS Control Plane Database (COMPLETE)\n-- ============================================================================\n-- Version: 2.0.0\n-- Updated: 2025-12-27\n-- Database: arc-saas-postgres (arc_saas database)\n-- Port: 5432\n--\n-- This consolidated migration includes ALL tables, columns, functions, types,\n-- indexes, constraints, and seed data from the Arc-SaaS Control Plane.\n--\n-- VERIFIED AGAINST LIVE DATABASE: December 27, 2025\n-- Total tables: 29 (22 in main, 3 in subscription, 4 in public)\n--\n-- USE THIS FOR:\n-- - Fresh database setup\n-- - Complete schema verification\n-- - Reference documentation\n-- - Database recovery/rebuild\n--\n-- IMPORTANT: This migration is IDEMPOTENT - safe to run multiple times.\n-- ============================================================================\n\nBEGIN;\n\n-- ============================================================================\n-- SECTION 1: EXTENSIONS\n-- ============================================================================\n\nCREATE EXTENSION IF NOT EXISTS \"uuid-ossp\";\nCREATE EXTENSION IF NOT EXISTS \"pgcrypto\";\n\n-- ============================================================================\n-- SECTION 2: SCHEMAS\n-- ============================================================================\n\nCREATE SCHEMA IF NOT EXISTS main;\nCREATE SCHEMA IF NOT EXISTS subscription;\n\n-- ============================================================================\n-- SECTION 3: CUSTOM TYPES (Subscription Schema)\n-- ============================================================================\n\nDO $$ BEGIN\n    CREATE TYPE subscription.billing_interval AS ENUM (\n        'monthly',\n        'yearly',\n        'one_time'\n    );\nEXCEPTION\n    WHEN duplicate_object THEN NULL;\nEND $$;\n\nDO $$ BEGIN\n    CREATE TYPE subscription.subscription_status AS ENUM (\n        'trialing',\n        'active',\n        'past_due',\n        'canceled',\n        'expired'\n    );\nEXCEPTION\n    WHEN duplicate_object THEN NULL;\nEND $$;\n\n-- ============================================================================\n-- SECTION 4: CORE FUNCTIONS\n-- ============================================================================\n\n-- Function: Create Tenant Schema (main schema)\nCREATE OR REPLACE FUNCTION main.create_tenant_schema(tenant_key VARCHAR)\nRETURNS VOID AS $$\nDECLARE\n    schema_name TEXT;\nBEGIN\n    schema_name := 'tenant_' || tenant_key;\n\n    -- Create the schema\n    EXECUTE format('CREATE SCHEMA IF NOT EXISTS %I', schema_name);\n\n    -- Create tenant-specific tables\n    EXECUTE format('\n        CREATE TABLE IF NOT EXISTS %I.users (\n            id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n            email VARCHAR(255) NOT NULL,\n            first_name VARCHAR(100),\n            last_name VARCHAR(100),\n            role VARCHAR(50) DEFAULT ''user'',\n            is_active BOOLEAN DEFAULT true,\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n            updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n        )', schema_name);\n\n    EXECUTE format('\n        CREATE TABLE IF NOT EXISTS %I.settings (\n            id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n            key VARCHAR(255) NOT NULL UNIQUE,\n            value JSONB,\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n            updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n        )', schema_name);\n\n    EXECUTE format('\n        CREATE TABLE IF NOT EXISTS %I.audit_logs (\n            id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n            user_id UUID,\n            action VARCHAR(100) NOT NULL,\n            entity_type VARCHAR(100),\n            entity_id UUID,\n            old_value JSONB,\n            new_value JSONB,\n            ip_address VARCHAR(45),\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n        )', schema_name);\n\n    EXECUTE format('\n        CREATE TABLE IF NOT EXISTS %I.orders (\n            id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n            order_number VARCHAR(50) NOT NULL,\n            status VARCHAR(50) DEFAULT ''pending'',\n            total_amount DECIMAL(15,2),\n            currency VARCHAR(3) DEFAULT ''USD'',\n            customer_id UUID,\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n            updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n        )', schema_name);\n\n    EXECUTE format('\n        CREATE TABLE IF NOT EXISTS %I.customers (\n            id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n            name VARCHAR(255) NOT NULL,\n            email VARCHAR(255),\n            phone VARCHAR(50),\n            address JSONB,\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n            updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n        )', schema_name);\n\n    EXECUTE format('\n        CREATE TABLE IF NOT EXISTS %I.products (\n            id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n            name VARCHAR(255) NOT NULL,\n            sku VARCHAR(100),\n            description TEXT,\n            price DECIMAL(15,2),\n            stock_quantity INTEGER DEFAULT 0,\n            is_active BOOLEAN DEFAULT true,\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n            updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n        )', schema_name);\n\n    EXECUTE format('\n        CREATE TABLE IF NOT EXISTS %I.order_items (\n            id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n            order_id UUID REFERENCES %I.orders(id),\n            product_id UUID REFERENCES %I.products(id),\n            quantity INTEGER NOT NULL,\n            unit_price DECIMAL(15,2),\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n        )', schema_name, schema_name, schema_name);\n\n    EXECUTE format('\n        CREATE TABLE IF NOT EXISTS %I.notifications (\n            id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n            user_id UUID,\n            type VARCHAR(50) NOT NULL,\n            title VARCHAR(255),\n            message TEXT,\n            is_read BOOLEAN DEFAULT false,\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n        )', schema_name);\n\n    RAISE NOTICE 'Created schema % with tenant tables', schema_name;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Function: Drop Tenant Schema (main schema)\nCREATE OR REPLACE FUNCTION main.drop_tenant_schema(tenant_key VARCHAR)\nRETURNS VOID AS $$\nDECLARE\n    schema_name TEXT;\nBEGIN\n    schema_name := 'tenant_' || tenant_key;\n    EXECUTE format('DROP SCHEMA IF EXISTS %I CASCADE', schema_name);\n    RAISE NOTICE 'Dropped schema %', schema_name;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Function: Create Tenant Schema (public schema - backward compatibility)\nCREATE OR REPLACE FUNCTION public.create_tenant_schema(tenant_key VARCHAR)\nRETURNS VOID AS $$\nDECLARE\n    schema_name VARCHAR;\nBEGIN\n    schema_name := 'tenant_' || tenant_key;\n\n    EXECUTE format('CREATE SCHEMA IF NOT EXISTS %I', schema_name);\n    EXECUTE format('GRANT ALL PRIVILEGES ON SCHEMA %I TO postgres', schema_name);\n\n    -- Create base tables for the tenant\n    EXECUTE format('\n        CREATE TABLE IF NOT EXISTS %I.users (\n            id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n            email VARCHAR(255) UNIQUE NOT NULL,\n            name VARCHAR(255),\n            role VARCHAR(50) DEFAULT ''user'',\n            status VARCHAR(50) DEFAULT ''active'',\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n            updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n        )', schema_name);\n\n    RAISE NOTICE 'Created tenant schema: %', schema_name;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Function: Drop Tenant Schema (public schema - backward compatibility)\nCREATE OR REPLACE FUNCTION public.drop_tenant_schema(tenant_key VARCHAR)\nRETURNS VOID AS $$\nDECLARE\n    schema_name VARCHAR;\nBEGIN\n    schema_name := 'tenant_' || tenant_key;\n    EXECUTE format('DROP SCHEMA IF EXISTS %I CASCADE', schema_name);\n    RAISE NOTICE 'Dropped tenant schema: %', schema_name;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- ============================================================================\n-- SECTION 5: MAIN SCHEMA TABLES\n-- ============================================================================\n\n-- Table: addresses\nCREATE TABLE IF NOT EXISTS main.addresses (\n    id UUID DEFAULT (md5((random()::text || clock_timestamp()::text)))::uuid NOT NULL PRIMARY KEY,\n    address VARCHAR(500),\n    city VARCHAR(100),\n    state VARCHAR(100),\n    zip VARCHAR(25),\n    country VARCHAR(25),\n    created_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    modified_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    deleted BOOLEAN DEFAULT false NOT NULL,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID,\n    created_by UUID,\n    modified_by UUID\n);\n\nCOMMENT ON TABLE main.addresses IS 'represents the addresses of leads and tenants';\n\n-- Table: tenants\nCREATE TABLE IF NOT EXISTS main.tenants (\n    id UUID DEFAULT (md5((random()::text || clock_timestamp()::text)))::uuid NOT NULL PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    key VARCHAR(20) NOT NULL UNIQUE,\n    status SMALLINT DEFAULT 0 NOT NULL,\n    domains VARCHAR[] DEFAULT '{}'::VARCHAR[] NOT NULL,\n    metadata JSONB DEFAULT '{}'::jsonb,\n    identity_provider VARCHAR(50) DEFAULT 'keycloak'::VARCHAR NOT NULL\n        CHECK (identity_provider IN ('keycloak', 'auth0', 'cognito')),\n    schema_name VARCHAR(100),\n    spoc_user_id UUID,\n    lead_id UUID,\n    address_id UUID,\n    created_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    modified_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    created_by UUID,\n    modified_by UUID,\n    deleted BOOLEAN DEFAULT false NOT NULL,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID,\n    CONSTRAINT fk_tenants_address FOREIGN KEY (address_id) REFERENCES main.addresses(id)\n);\n\nCOMMENT ON TABLE main.tenants IS 'represents the tenants in the multi-tenant platform';\nCOMMENT ON COLUMN main.tenants.identity_provider IS 'Identity provider type: keycloak, auth0, or cognito';\nCOMMENT ON COLUMN main.tenants.status IS 'status of a tenant, it can be - 0(active), 1(provisioning),2(deprovisioning),3(inactive)';\nCOMMENT ON COLUMN main.tenants.key IS 'a short string used to identify a tenant. This is also used as the namespace and subdomain for this particular tenant';\n\nCREATE INDEX IF NOT EXISTS idx_tenants_key ON main.tenants(key) WHERE deleted = false;\nCREATE INDEX IF NOT EXISTS idx_tenants_status ON main.tenants(status) WHERE deleted = false;\n\n-- Table: leads\nCREATE TABLE IF NOT EXISTS main.leads (\n    id UUID DEFAULT (md5((random()::text || clock_timestamp()::text)))::uuid NOT NULL PRIMARY KEY,\n    first_name VARCHAR(100) NOT NULL,\n    last_name VARCHAR(100) NOT NULL,\n    email VARCHAR(100) NOT NULL UNIQUE,\n    company_name VARCHAR(100),\n    is_validated BOOLEAN DEFAULT false NOT NULL,\n    address_id UUID,\n    created_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    modified_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    deleted BOOLEAN DEFAULT false NOT NULL,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID,\n    created_by UUID,\n    modified_by UUID,\n    CONSTRAINT fk_leads_address FOREIGN KEY (address_id) REFERENCES main.addresses(id)\n);\n\nCOMMENT ON TABLE main.leads IS 'represents the leads that could or could not lead to an actual tenant as a customer for application.';\n\nCREATE INDEX IF NOT EXISTS idx_leads_email ON main.leads(email) WHERE deleted = false;\n\n-- Table: contacts\nCREATE TABLE IF NOT EXISTS main.contacts (\n    id UUID DEFAULT (md5((random()::text || clock_timestamp()::text)))::uuid NOT NULL PRIMARY KEY,\n    first_name VARCHAR(100) NOT NULL,\n    last_name VARCHAR(100) NOT NULL,\n    email VARCHAR(100) NOT NULL,\n    contact_type VARCHAR(100),\n    is_primary BOOLEAN DEFAULT false NOT NULL,\n    tenant_id UUID NOT NULL REFERENCES main.tenants(id),\n    created_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    modified_on TIMESTAMPTZ,\n    created_by UUID,\n    modified_by UUID,\n    deleted BOOLEAN DEFAULT false NOT NULL,\n    deleted_by UUID,\n    deleted_on TIMESTAMPTZ\n);\n\nCOMMENT ON TABLE main.contacts IS 'represents contacts of a tenant';\n\nCREATE INDEX IF NOT EXISTS idx_contacts_tenant_id ON main.contacts(tenant_id) WHERE deleted = false;\n\n-- Table: branding_metadata\nCREATE TABLE IF NOT EXISTS main.branding_metadata (\n    id UUID DEFAULT (md5((random()::text || clock_timestamp()::text)))::uuid NOT NULL PRIMARY KEY,\n    theme_metadata JSONB,\n    description VARCHAR(500),\n    logo VARCHAR(500),\n    website VARCHAR(500),\n    tenant_id UUID NOT NULL,\n    CONSTRAINT fk_branding_metadata_tenants FOREIGN KEY (tenant_id) REFERENCES main.tenants(id)\n);\n\nCOMMENT ON TABLE main.branding_metadata IS 'Branding and theme customization for tenants';\n\n-- Table: users\nCREATE TABLE IF NOT EXISTS main.users (\n    id UUID DEFAULT (md5((random()::text || clock_timestamp()::text)))::uuid NOT NULL PRIMARY KEY,\n    email VARCHAR(255) NOT NULL,\n    first_name VARCHAR(100) NOT NULL,\n    last_name VARCHAR(100) NOT NULL,\n    auth_id VARCHAR(255),\n    keycloak_user_id VARCHAR(255),\n    status SMALLINT DEFAULT 0 NOT NULL,\n    role VARCHAR(50) DEFAULT 'user',\n    is_active BOOLEAN DEFAULT true,\n    permissions JSONB DEFAULT '[]'::jsonb,\n    tenant_id UUID NOT NULL REFERENCES main.tenants(id),\n    phone VARCHAR(50),\n    avatar_url VARCHAR(500),\n    last_login TIMESTAMPTZ,\n    created_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    modified_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    created_by UUID,\n    modified_by UUID,\n    deleted BOOLEAN DEFAULT false NOT NULL,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID,\n    CONSTRAINT uk_users_email_tenant UNIQUE (email, tenant_id)\n);\n\nCOMMENT ON TABLE main.users IS 'User accounts with multi-tenant support and Keycloak SSO integration';\nCOMMENT ON COLUMN main.users.auth_id IS 'Keycloak user UUID for SSO authentication';\nCOMMENT ON COLUMN main.users.keycloak_user_id IS 'Keycloak username/email for SSO lookup';\nCOMMENT ON COLUMN main.users.role IS 'User role: super_admin, owner, admin, engineer, analyst';\nCOMMENT ON COLUMN main.users.is_active IS 'Whether the user account is active';\nCOMMENT ON COLUMN main.users.permissions IS 'JSON array of additional permissions';\nCOMMENT ON COLUMN main.users.status IS '0=pending, 1=active, 2=suspended, 3=deactivated';\n\nCREATE INDEX IF NOT EXISTS idx_users_email ON main.users(email) WHERE deleted = false;\nCREATE INDEX IF NOT EXISTS idx_users_status ON main.users(status) WHERE deleted = false;\nCREATE INDEX IF NOT EXISTS idx_users_tenant_id ON main.users(tenant_id) WHERE deleted = false;\nCREATE UNIQUE INDEX IF NOT EXISTS uk_users_auth_id ON main.users(auth_id) WHERE auth_id IS NOT NULL;\n\n-- Table: user_roles\nCREATE TABLE IF NOT EXISTS main.user_roles (\n    id UUID DEFAULT (md5((random()::text || clock_timestamp()::text)))::uuid NOT NULL PRIMARY KEY,\n    user_id UUID NOT NULL REFERENCES main.users(id) ON DELETE CASCADE,\n    role_key VARCHAR(50) NOT NULL,\n    permissions TEXT[],\n    scope_type VARCHAR(50) DEFAULT 'tenant'::VARCHAR NOT NULL,\n    scope_id UUID,\n    tenant_id UUID NOT NULL REFERENCES main.tenants(id),\n    created_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    modified_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    created_by UUID,\n    modified_by UUID,\n    deleted BOOLEAN DEFAULT false NOT NULL,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID,\n    CONSTRAINT uk_user_roles_unique UNIQUE (user_id, role_key, scope_type, scope_id)\n);\n\nCOMMENT ON TABLE main.user_roles IS 'User role assignments with support for tenant, workspace, and project level permissions';\nCOMMENT ON COLUMN main.user_roles.role_key IS 'Role identifier (super_admin, owner, admin, engineer, analyst)';\nCOMMENT ON COLUMN main.user_roles.permissions IS 'Array of permission codes granted by this role';\nCOMMENT ON COLUMN main.user_roles.scope_type IS 'Scope of the role: tenant (org-wide), workspace, or project';\nCOMMENT ON COLUMN main.user_roles.scope_id IS 'NULL for tenant-level roles, otherwise references workspace or project';\n\nCREATE INDEX IF NOT EXISTS idx_user_roles_user_id ON main.user_roles(user_id) WHERE deleted = false;\nCREATE INDEX IF NOT EXISTS idx_user_roles_role_key ON main.user_roles(role_key) WHERE deleted = false;\nCREATE INDEX IF NOT EXISTS idx_user_roles_scope ON main.user_roles(scope_type, scope_id) WHERE deleted = false;\nCREATE INDEX IF NOT EXISTS idx_user_roles_tenant_id ON main.user_roles(tenant_id) WHERE deleted = false;\n\n-- Table: user_invitations\nCREATE TABLE IF NOT EXISTS main.user_invitations (\n    id UUID DEFAULT (md5((random()::text || clock_timestamp()::text)))::uuid NOT NULL PRIMARY KEY,\n    email VARCHAR(255) NOT NULL,\n    token VARCHAR(255) NOT NULL UNIQUE,\n    role_key VARCHAR(50) NOT NULL,\n    invited_by UUID NOT NULL REFERENCES main.users(id),\n    tenant_id UUID NOT NULL REFERENCES main.tenants(id),\n    expires_at TIMESTAMPTZ NOT NULL,\n    status SMALLINT DEFAULT 0 NOT NULL,\n    accepted_at TIMESTAMPTZ,\n    accepted_by UUID REFERENCES main.users(id),\n    first_name VARCHAR(100),\n    last_name VARCHAR(100),\n    custom_message TEXT,\n    last_email_sent_at TIMESTAMPTZ,\n    resend_count INTEGER DEFAULT 0 NOT NULL,\n    created_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    modified_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    created_by UUID,\n    modified_by UUID,\n    deleted BOOLEAN DEFAULT false NOT NULL,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID,\n    CONSTRAINT ck_user_invitations_expires_future CHECK (expires_at \u003e created_on),\n    CONSTRAINT ck_user_invitations_token_length CHECK (length(token) \u003e= 32)\n);\n\nCOMMENT ON TABLE main.user_invitations IS 'User invitation tokens with role assignment and expiration tracking';\nCOMMENT ON COLUMN main.user_invitations.token IS 'Secure random token embedded in invitation link';\nCOMMENT ON COLUMN main.user_invitations.expires_at IS 'Invitation expiration timestamp (typically created_on + 7 days)';\nCOMMENT ON COLUMN main.user_invitations.status IS '0=pending, 1=accepted, 2=expired, 3=revoked';\n\nCREATE INDEX IF NOT EXISTS idx_user_invitations_email ON main.user_invitations(email) WHERE deleted = false;\nCREATE INDEX IF NOT EXISTS idx_user_invitations_token ON main.user_invitations(token) WHERE deleted = false AND status = 0;\nCREATE INDEX IF NOT EXISTS idx_user_invitations_tenant_id ON main.user_invitations(tenant_id) WHERE deleted = false;\nCREATE INDEX IF NOT EXISTS idx_user_invitations_status ON main.user_invitations(status) WHERE deleted = false;\n\n-- Table: user_activities\nCREATE TABLE IF NOT EXISTS main.user_activities (\n    id UUID DEFAULT (md5((random()::text || clock_timestamp()::text)))::uuid NOT NULL PRIMARY KEY,\n    user_id UUID NOT NULL REFERENCES main.users(id) ON DELETE CASCADE,\n    tenant_id UUID NOT NULL REFERENCES main.tenants(id),\n    action VARCHAR(100) NOT NULL,\n    entity_type VARCHAR(50),\n    entity_id UUID,\n    metadata JSONB,\n    ip_address VARCHAR(45),\n    user_agent TEXT,\n    occurred_at TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCOMMENT ON TABLE main.user_activities IS 'User activity log for audit trail and user behavior tracking';\nCOMMENT ON COLUMN main.user_activities.action IS 'Action identifier (e.g., user.created, user.login, user.role_changed)';\nCOMMENT ON COLUMN main.user_activities.entity_type IS 'Type of entity affected by the action';\nCOMMENT ON COLUMN main.user_activities.entity_id IS 'UUID of the affected entity';\nCOMMENT ON COLUMN main.user_activities.metadata IS 'JSON metadata containing additional context (changed fields, IP, user agent, etc.)';\nCOMMENT ON COLUMN main.user_activities.occurred_at IS 'Timestamp when the activity occurred';\n\nCREATE INDEX IF NOT EXISTS idx_user_activities_user_id ON main.user_activities(user_id);\nCREATE INDEX IF NOT EXISTS idx_user_activities_tenant_id ON main.user_activities(tenant_id);\nCREATE INDEX IF NOT EXISTS idx_user_activities_occurred_at ON main.user_activities(occurred_at);\nCREATE INDEX IF NOT EXISTS idx_user_activities_action ON main.user_activities(action);\n\n-- Table: audit_logs\nCREATE TABLE IF NOT EXISTS main.audit_logs (\n    id UUID DEFAULT gen_random_uuid() NOT NULL PRIMARY KEY,\n    action VARCHAR(100) NOT NULL,\n    actor_id UUID NOT NULL,\n    actor_name VARCHAR(200),\n    actor_email VARCHAR(255),\n    target_type VARCHAR(50),\n    target_id UUID,\n    target_name VARCHAR(200),\n    tenant_id UUID,\n    tenant_name VARCHAR(200),\n    details JSONB,\n    ip_address VARCHAR(45),\n    user_agent TEXT,\n    status VARCHAR(20) DEFAULT 'success'::VARCHAR NOT NULL,\n    timestamp TIMESTAMPTZ DEFAULT now() NOT NULL\n);\n\nCOMMENT ON TABLE main.audit_logs IS 'System-wide audit log for security and compliance tracking';\n\nCREATE INDEX IF NOT EXISTS idx_audit_logs_actor_id ON main.audit_logs(actor_id);\nCREATE INDEX IF NOT EXISTS idx_audit_logs_tenant_id ON main.audit_logs(tenant_id);\nCREATE INDEX IF NOT EXISTS idx_audit_logs_timestamp ON main.audit_logs(timestamp);\nCREATE INDEX IF NOT EXISTS idx_audit_logs_action ON main.audit_logs(action);\n\n-- Table: plans\nCREATE TABLE IF NOT EXISTS main.plans (\n    id VARCHAR(100) PRIMARY KEY,\n    name VARCHAR(255) NOT NULL,\n    description TEXT,\n    tier VARCHAR(50) NOT NULL,\n    price DECIMAL(10, 2) NOT NULL DEFAULT 0,\n    billing_cycle VARCHAR(20) NOT NULL DEFAULT 'month',\n    features JSONB DEFAULT '[]'::jsonb,\n    is_active BOOLEAN DEFAULT true,\n    limits JSONB DEFAULT '{}'::jsonb,\n    trial_enabled BOOLEAN DEFAULT false,\n    trial_duration INTEGER DEFAULT 14,\n    trial_duration_unit VARCHAR(20) DEFAULT 'days',\n    stripe_product_id VARCHAR(255),\n    stripe_price_id VARCHAR(255),\n    is_popular BOOLEAN DEFAULT false,\n    sort_order INTEGER DEFAULT 0,\n    created_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    modified_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    created_by VARCHAR(255),\n    modified_by VARCHAR(255),\n    deleted BOOLEAN DEFAULT false,\n    deleted_on TIMESTAMPTZ,\n    deleted_by VARCHAR(255)\n);\n\nCOMMENT ON TABLE main.plans IS 'Subscription plans with pricing and feature definitions';\n\nCREATE INDEX IF NOT EXISTS idx_plans_tier ON main.plans(tier);\nCREATE INDEX IF NOT EXISTS idx_plans_is_active ON main.plans(is_active);\nCREATE INDEX IF NOT EXISTS idx_plans_sort_order ON main.plans(sort_order);\n\n-- Table: subscriptions\nCREATE TABLE IF NOT EXISTS main.subscriptions (\n    id UUID DEFAULT gen_random_uuid() NOT NULL PRIMARY KEY,\n    tenant_id UUID REFERENCES main.tenants(id),\n    planid VARCHAR(100) NOT NULL,\n    planname VARCHAR(100) NOT NULL,\n    plantier VARCHAR(50) NOT NULL,\n    status VARCHAR(50) DEFAULT 'active'::VARCHAR NOT NULL,\n    current_period_start TIMESTAMPTZ NOT NULL,\n    current_period_end TIMESTAMPTZ NOT NULL,\n    trial_start TIMESTAMPTZ,\n    trial_end TIMESTAMPTZ,\n    amount DECIMAL(10,2) NOT NULL,\n    currency VARCHAR(3) DEFAULT 'USD'::VARCHAR NOT NULL,\n    billing_cycle VARCHAR(20) DEFAULT 'monthly'::VARCHAR NOT NULL,\n    cancel_at_period_end BOOLEAN DEFAULT false,\n    canceled_at TIMESTAMPTZ,\n    cancel_reason TEXT,\n    metadata JSONB,\n    deleted BOOLEAN DEFAULT false,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID,\n    created_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    modified_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    created_by UUID,\n    modified_by UUID\n);\n\nCOMMENT ON TABLE main.subscriptions IS 'Tenant subscription records with billing details';\n\nCREATE INDEX IF NOT EXISTS idx_subscriptions_tenant_id ON main.subscriptions(tenant_id) WHERE deleted = false;\nCREATE INDEX IF NOT EXISTS idx_subscriptions_status ON main.subscriptions(status) WHERE deleted = false;\n\n-- Table: invoices\nCREATE TABLE IF NOT EXISTS main.invoices (\n    id UUID DEFAULT gen_random_uuid() NOT NULL PRIMARY KEY,\n    tenant_id UUID NOT NULL REFERENCES main.tenants(id),\n    start_date VARCHAR(50) NOT NULL,\n    end_date VARCHAR(50) NOT NULL,\n    amount DECIMAL(10,2) NOT NULL,\n    currency_code VARCHAR(10) NOT NULL,\n    invoice_file VARCHAR(500),\n    due_date VARCHAR(50) NOT NULL,\n    status INTEGER DEFAULT 0 NOT NULL,\n    deleted BOOLEAN DEFAULT false,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID,\n    created_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    modified_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    created_by UUID,\n    modified_by UUID\n);\n\nCOMMENT ON TABLE main.invoices IS 'Invoices for tenant billing';\nCOMMENT ON COLUMN main.invoices.status IS 'status of the invoice, 0 - pending, 1 - paid';\n\nCREATE INDEX IF NOT EXISTS idx_invoices_tenant_id ON main.invoices(tenant_id) WHERE deleted = false;\nCREATE INDEX IF NOT EXISTS idx_invoices_status ON main.invoices(status) WHERE deleted = false;\n\n-- Table: payment_methods\nCREATE TABLE IF NOT EXISTS main.payment_methods (\n    id UUID DEFAULT gen_random_uuid() NOT NULL PRIMARY KEY,\n    tenant_id UUID NOT NULL REFERENCES main.tenants(id),\n    stripe_payment_method_id VARCHAR(255) NOT NULL,\n    stripe_customer_id VARCHAR(255),\n    type VARCHAR(50) NOT NULL,\n    card_details JSONB,\n    bank_account_details JSONB,\n    is_default BOOLEAN DEFAULT false,\n    billing_name VARCHAR(255),\n    billing_email VARCHAR(255),\n    billing_address JSONB,\n    metadata JSONB,\n    deleted BOOLEAN DEFAULT false,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID,\n    created_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    modified_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    created_by UUID,\n    modified_by UUID\n);\n\nCOMMENT ON TABLE main.payment_methods IS 'Stores payment methods (cards, bank accounts) for tenant billing via Stripe';\n\nCREATE INDEX IF NOT EXISTS idx_payment_methods_tenant_id ON main.payment_methods(tenant_id) WHERE deleted = false;\nCREATE INDEX IF NOT EXISTS idx_payment_methods_stripe_id ON main.payment_methods(stripe_payment_method_id);\n\n-- Table: payment_intents\nCREATE TABLE IF NOT EXISTS main.payment_intents (\n    id UUID DEFAULT gen_random_uuid() NOT NULL PRIMARY KEY,\n    tenant_id UUID NOT NULL REFERENCES main.tenants(id),\n    invoice_id UUID REFERENCES main.invoices(id),\n    stripe_payment_intent_id VARCHAR(255) NOT NULL,\n    stripe_customer_id VARCHAR(255),\n    stripe_payment_method_id VARCHAR(255),\n    amount INTEGER NOT NULL,\n    currency VARCHAR(3) DEFAULT 'usd'::VARCHAR NOT NULL,\n    status VARCHAR(50) DEFAULT 'requires_payment_method'::VARCHAR NOT NULL,\n    client_secret VARCHAR(500),\n    description TEXT,\n    receipt_email VARCHAR(255),\n    failure_code VARCHAR(100),\n    failure_message TEXT,\n    succeeded_at TIMESTAMPTZ,\n    cancelled_at TIMESTAMPTZ,\n    cancellation_reason VARCHAR(100),\n    amount_received INTEGER,\n    metadata JSONB,\n    deleted BOOLEAN DEFAULT false,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID,\n    created_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    modified_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    created_by UUID,\n    modified_by UUID\n);\n\nCOMMENT ON TABLE main.payment_intents IS 'Tracks Stripe payment intents for invoice payments';\n\nCREATE INDEX IF NOT EXISTS idx_payment_intents_tenant_id ON main.payment_intents(tenant_id) WHERE deleted = false;\nCREATE INDEX IF NOT EXISTS idx_payment_intents_stripe_id ON main.payment_intents(stripe_payment_intent_id);\nCREATE INDEX IF NOT EXISTS idx_payment_intents_status ON main.payment_intents(status);\n\n-- Table: settings\nCREATE TABLE IF NOT EXISTS main.settings (\n    id UUID DEFAULT public.uuid_generate_v4() NOT NULL PRIMARY KEY,\n    config_key VARCHAR(100) NOT NULL UNIQUE,\n    config_value TEXT,\n    value_type VARCHAR(20) DEFAULT 'string'::VARCHAR,\n    description TEXT,\n    category VARCHAR(50),\n    is_public BOOLEAN DEFAULT false,\n    created_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    modified_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    created_by UUID,\n    modified_by UUID,\n    deleted BOOLEAN DEFAULT false,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID\n);\n\nCOMMENT ON TABLE main.settings IS 'Platform-wide configuration settings';\nCOMMENT ON COLUMN main.settings.config_key IS 'Unique key for the setting (e.g., platform.name, email.sender)';\nCOMMENT ON COLUMN main.settings.config_value IS 'Value of the setting';\nCOMMENT ON COLUMN main.settings.value_type IS 'Data type: string, number, boolean, json';\nCOMMENT ON COLUMN main.settings.category IS 'Category for grouping settings (e.g., general, email, billing)';\nCOMMENT ON COLUMN main.settings.is_public IS 'Whether this setting is visible to non-admin users';\n\nCREATE INDEX IF NOT EXISTS idx_settings_category ON main.settings(category) WHERE deleted = false;\n\n-- Table: resources\nCREATE TABLE IF NOT EXISTS main.resources (\n    id UUID DEFAULT (md5((random()::text || clock_timestamp()::text)))::uuid NOT NULL PRIMARY KEY,\n    type VARCHAR(100) NOT NULL,\n    metadata JSONB NOT NULL,\n    external_identifier VARCHAR(200) NOT NULL,\n    tenant_id UUID NOT NULL REFERENCES main.tenants(id),\n    created_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    modified_on TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    created_by UUID,\n    modified_by UUID,\n    deleted BOOLEAN DEFAULT false NOT NULL,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID,\n    CONSTRAINT idx_resource_ext_id UNIQUE (external_identifier, tenant_id)\n);\n\nCOMMENT ON TABLE main.resources IS 'model for resources that are provisioned for a tenant';\nCOMMENT ON COLUMN main.resources.type IS 'type of the resource like storage, compute, etc';\nCOMMENT ON COLUMN main.resources.metadata IS 'any type specific metadata of the resource like connection info, size, etc';\nCOMMENT ON COLUMN main.resources.external_identifier IS 'identifier for the resource in the external system it was provisioned';\n\nCREATE INDEX IF NOT EXISTS idx_resources_tenant_id ON main.resources(tenant_id) WHERE deleted = false;\nCREATE INDEX IF NOT EXISTS idx_resources_type ON main.resources(type) WHERE deleted = false;\n\n-- Table: platform_config\nCREATE TABLE IF NOT EXISTS main.platform_config (\n    id UUID DEFAULT public.uuid_generate_v4() NOT NULL PRIMARY KEY,\n    key VARCHAR(100) NOT NULL UNIQUE,\n    value JSONB DEFAULT '{}'::jsonb NOT NULL,\n    description TEXT,\n    created_at TIMESTAMPTZ DEFAULT now(),\n    updated_at TIMESTAMPTZ DEFAULT now()\n);\n\nCOMMENT ON TABLE main.platform_config IS 'Platform-level configuration for features and integrations';\n\n-- Table: feature_flags\nCREATE TABLE IF NOT EXISTS main.feature_flags (\n    id UUID DEFAULT public.uuid_generate_v4() NOT NULL PRIMARY KEY,\n    name VARCHAR(100) NOT NULL UNIQUE,\n    enabled BOOLEAN DEFAULT false,\n    description TEXT,\n    metadata JSONB DEFAULT '{}'::jsonb,\n    created_at TIMESTAMPTZ DEFAULT now(),\n    updated_at TIMESTAMPTZ DEFAULT now()\n);\n\nCOMMENT ON TABLE main.feature_flags IS 'Feature flags for enabling/disabling platform features';\n\n-- Table: notification_history\nCREATE TABLE IF NOT EXISTS main.notification_history (\n    id UUID DEFAULT gen_random_uuid() NOT NULL PRIMARY KEY,\n    tenant_id UUID NOT NULL REFERENCES main.tenants(id),\n    workflow_id VARCHAR(255) NOT NULL,\n    workflow_name VARCHAR(255),\n    subscriber_id VARCHAR(255) NOT NULL,\n    channel VARCHAR(50) NOT NULL CHECK (channel IN ('email', 'sms', 'push', 'in_app', 'webhook')),\n    status VARCHAR(50) DEFAULT 'pending'::VARCHAR NOT NULL\n        CHECK (status IN ('pending', 'sent', 'delivered', 'failed', 'bounced', 'opened', 'clicked')),\n    recipient_email VARCHAR(255),\n    recipient_phone VARCHAR(50),\n    subject VARCHAR(500),\n    payload JSONB,\n    transaction_id VARCHAR(255),\n    novu_message_id VARCHAR(255),\n    attempts INTEGER DEFAULT 1,\n    error_message TEXT,\n    error_code VARCHAR(100),\n    sent_at TIMESTAMPTZ,\n    delivered_at TIMESTAMPTZ,\n    opened_at TIMESTAMPTZ,\n    clicked_at TIMESTAMPTZ,\n    category VARCHAR(100),\n    metadata JSONB,\n    created_by UUID,\n    modified_by UUID,\n    created_on TIMESTAMPTZ DEFAULT now(),\n    modified_on TIMESTAMPTZ DEFAULT now(),\n    deleted BOOLEAN DEFAULT false,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID\n);\n\nCOMMENT ON TABLE main.notification_history IS 'History of all notifications sent via Novu';\n\nCREATE INDEX IF NOT EXISTS idx_notification_history_tenant_id ON main.notification_history(tenant_id);\nCREATE INDEX IF NOT EXISTS idx_notification_history_status ON main.notification_history(status);\nCREATE INDEX IF NOT EXISTS idx_notification_history_workflow_id ON main.notification_history(workflow_id);\n\n-- Table: tenant_quotas\nCREATE TABLE IF NOT EXISTS main.tenant_quotas (\n    id UUID DEFAULT gen_random_uuid() NOT NULL PRIMARY KEY,\n    tenant_id UUID NOT NULL REFERENCES main.tenants(id),\n    metric_type VARCHAR(50) NOT NULL\n        CHECK (metric_type IN ('api_calls', 'storage_gb', 'users', 'workflows', 'integrations', 'custom')),\n    metric_name VARCHAR(100),\n    soft_limit DECIMAL(20,4) NOT NULL,\n    hard_limit DECIMAL(20,4) NOT NULL,\n    current_usage DECIMAL(20,4) DEFAULT 0,\n    unit VARCHAR(50) DEFAULT 'units'::VARCHAR,\n    reset_period VARCHAR(20) DEFAULT 'monthly'::VARCHAR\n        CHECK (reset_period IN ('hourly', 'daily', 'weekly', 'monthly', 'yearly', 'never')),\n    last_reset TIMESTAMPTZ,\n    next_reset TIMESTAMPTZ,\n    overage_rate DECIMAL(10,4) DEFAULT 0,\n    allow_overage BOOLEAN DEFAULT false,\n    is_active BOOLEAN DEFAULT true,\n    metadata JSONB,\n    created_by UUID,\n    modified_by UUID,\n    created_on TIMESTAMPTZ DEFAULT now(),\n    modified_on TIMESTAMPTZ DEFAULT now(),\n    deleted BOOLEAN DEFAULT false,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID\n);\n\nCOMMENT ON TABLE main.tenant_quotas IS 'Usage quotas and limits for each tenant';\n\nCREATE INDEX IF NOT EXISTS idx_tenant_quotas_tenant_id ON main.tenant_quotas(tenant_id) WHERE deleted = false;\nCREATE INDEX IF NOT EXISTS idx_tenant_quotas_metric_type ON main.tenant_quotas(metric_type);\n\n-- Table: usage_events\nCREATE TABLE IF NOT EXISTS main.usage_events (\n    id UUID DEFAULT gen_random_uuid() NOT NULL PRIMARY KEY,\n    tenant_id UUID NOT NULL REFERENCES main.tenants(id),\n    metric_type VARCHAR(50) NOT NULL\n        CHECK (metric_type IN ('api_calls', 'storage_gb', 'users', 'workflows', 'integrations', 'custom')),\n    metric_name VARCHAR(100),\n    quantity DECIMAL(20,4) DEFAULT 1 NOT NULL,\n    unit VARCHAR(50) DEFAULT 'units'::VARCHAR,\n    event_timestamp TIMESTAMPTZ DEFAULT now() NOT NULL,\n    billing_period VARCHAR(7),\n    source VARCHAR(100),\n    resource_id VARCHAR(255),\n    metadata JSONB,\n    created_by UUID,\n    modified_by UUID,\n    created_on TIMESTAMPTZ DEFAULT now(),\n    modified_on TIMESTAMPTZ DEFAULT now(),\n    deleted BOOLEAN DEFAULT false,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID\n);\n\nCOMMENT ON TABLE main.usage_events IS 'Individual usage events for billing and analytics';\n\nCREATE INDEX IF NOT EXISTS idx_usage_events_tenant_id ON main.usage_events(tenant_id);\nCREATE INDEX IF NOT EXISTS idx_usage_events_timestamp ON main.usage_events(event_timestamp);\nCREATE INDEX IF NOT EXISTS idx_usage_events_billing_period ON main.usage_events(billing_period);\n\n-- Table: usage_summaries\nCREATE TABLE IF NOT EXISTS main.usage_summaries (\n    id UUID DEFAULT gen_random_uuid() NOT NULL PRIMARY KEY,\n    tenant_id UUID NOT NULL REFERENCES main.tenants(id),\n    metric_type VARCHAR(50) NOT NULL\n        CHECK (metric_type IN ('api_calls', 'storage_gb', 'users', 'workflows', 'integrations', 'custom')),\n    billing_period VARCHAR(7) NOT NULL,\n    total_quantity DECIMAL(20,4) DEFAULT 0 NOT NULL,\n    included_quantity DECIMAL(20,4) DEFAULT 0,\n    overage_quantity DECIMAL(20,4) DEFAULT 0,\n    overage_amount DECIMAL(20,4) DEFAULT 0,\n    unit VARCHAR(50) DEFAULT 'units'::VARCHAR,\n    event_count INTEGER DEFAULT 0,\n    peak_usage DECIMAL(20,4),\n    average_usage DECIMAL(20,4),\n    period_start TIMESTAMPTZ,\n    period_end TIMESTAMPTZ,\n    last_updated TIMESTAMPTZ DEFAULT now(),\n    metadata JSONB,\n    created_by UUID,\n    modified_by UUID,\n    created_on TIMESTAMPTZ DEFAULT now(),\n    modified_on TIMESTAMPTZ DEFAULT now(),\n    deleted BOOLEAN DEFAULT false,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID\n);\n\nCOMMENT ON TABLE main.usage_summaries IS 'Aggregated usage summaries per tenant per billing period';\n\nCREATE INDEX IF NOT EXISTS idx_usage_summaries_tenant_id ON main.usage_summaries(tenant_id);\nCREATE INDEX IF NOT EXISTS idx_usage_summaries_period ON main.usage_summaries(billing_period);\n\n-- ============================================================================\n-- SECTION 6: SUBSCRIPTION SCHEMA TABLES\n-- ============================================================================\n\n-- Table: subscription.plans\nCREATE TABLE IF NOT EXISTS subscription.plans (\n    id UUID DEFAULT uuid_generate_v4() NOT NULL PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    description TEXT,\n    tier VARCHAR(50) NOT NULL,\n    price DECIMAL(10,2) NOT NULL DEFAULT 0,\n    billing_interval subscription.billing_interval DEFAULT 'monthly'::subscription.billing_interval,\n    features JSONB DEFAULT '[]'::jsonb,\n    is_active BOOLEAN DEFAULT true,\n    metadata JSONB DEFAULT '{}'::jsonb,\n    created_at TIMESTAMPTZ DEFAULT now(),\n    updated_at TIMESTAMPTZ DEFAULT now()\n);\n\nCOMMENT ON TABLE subscription.plans IS 'Subscription plan definitions (subscription schema)';\n\nCREATE INDEX IF NOT EXISTS idx_subscription_plans_tier ON subscription.plans(tier);\nCREATE INDEX IF NOT EXISTS idx_subscription_plans_is_active ON subscription.plans(is_active);\n\n-- Table: subscription.subscriptions\nCREATE TABLE IF NOT EXISTS subscription.subscriptions (\n    id UUID DEFAULT uuid_generate_v4() NOT NULL PRIMARY KEY,\n    tenant_id UUID NOT NULL,\n    plan_id UUID NOT NULL REFERENCES subscription.plans(id),\n    status subscription.subscription_status DEFAULT 'active'::subscription.subscription_status,\n    billing_interval subscription.billing_interval DEFAULT 'monthly'::subscription.billing_interval,\n    start_date TIMESTAMPTZ DEFAULT now(),\n    end_date TIMESTAMPTZ,\n    trial_end_date TIMESTAMPTZ,\n    canceled_at TIMESTAMPTZ,\n    current_period_start TIMESTAMPTZ,\n    current_period_end TIMESTAMPTZ,\n    stripe_subscription_id VARCHAR(200),\n    stripe_customer_id VARCHAR(200),\n    created_at TIMESTAMPTZ DEFAULT now(),\n    updated_at TIMESTAMPTZ DEFAULT now()\n);\n\nCOMMENT ON TABLE subscription.subscriptions IS 'Active subscriptions (subscription schema)';\n\nCREATE INDEX IF NOT EXISTS idx_subscriptions_tenant ON subscription.subscriptions(tenant_id);\nCREATE INDEX IF NOT EXISTS idx_subscriptions_status ON subscription.subscriptions(status);\n\n-- Table: subscription.invoices\nCREATE TABLE IF NOT EXISTS subscription.invoices (\n    id UUID DEFAULT uuid_generate_v4() NOT NULL PRIMARY KEY,\n    subscription_id UUID REFERENCES subscription.subscriptions(id),\n    tenant_id UUID NOT NULL,\n    amount DECIMAL(10,2) NOT NULL,\n    currency VARCHAR(3) DEFAULT 'USD'::VARCHAR,\n    status VARCHAR(50) DEFAULT 'pending'::VARCHAR,\n    due_date TIMESTAMPTZ,\n    paid_at TIMESTAMPTZ,\n    invoice_number VARCHAR(100),\n    stripe_invoice_id VARCHAR(200),\n    metadata JSONB DEFAULT '{}'::jsonb,\n    created_at TIMESTAMPTZ DEFAULT now(),\n    updated_at TIMESTAMPTZ DEFAULT now()\n);\n\nCOMMENT ON TABLE subscription.invoices IS 'Subscription invoices (subscription schema)';\n\nCREATE INDEX IF NOT EXISTS idx_subscription_invoices_tenant ON subscription.invoices(tenant_id);\nCREATE INDEX IF NOT EXISTS idx_subscription_invoices_status ON subscription.invoices(status);\n\n-- ============================================================================\n-- SECTION 7: PUBLIC SCHEMA TABLES (Migration tracking)\n-- ============================================================================\n\n-- Table: public.migrations (db-migrate framework table)\nCREATE TABLE IF NOT EXISTS public.migrations (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(255) NOT NULL UNIQUE,\n    run_on TIMESTAMPTZ DEFAULT now() NOT NULL\n);\n\nCOMMENT ON TABLE public.migrations IS 'db-migrate framework migration tracking';\n\n-- Table: public.migrations_state (db-migrate framework table)\nCREATE TABLE IF NOT EXISTS public.migrations_state (\n    id SERIAL PRIMARY KEY,\n    current VARCHAR(255),\n    last_run TIMESTAMPTZ DEFAULT now()\n);\n\nCOMMENT ON TABLE public.migrations_state IS 'db-migrate framework state tracking';\n\n-- Table: public.audit_logs (legacy, may be duplicated with main.audit_logs)\nCREATE TABLE IF NOT EXISTS public.audit_logs (\n    id UUID DEFAULT gen_random_uuid() NOT NULL PRIMARY KEY,\n    action VARCHAR(100) NOT NULL,\n    actor_id UUID NOT NULL,\n    actor_name VARCHAR(200),\n    actor_email VARCHAR(255),\n    target_type VARCHAR(50),\n    target_id UUID,\n    target_name VARCHAR(200),\n    tenant_id UUID,\n    tenant_name VARCHAR(200),\n    details JSONB,\n    ip_address VARCHAR(45),\n    user_agent TEXT,\n    status VARCHAR(20) DEFAULT 'success'::VARCHAR NOT NULL,\n    timestamp TIMESTAMPTZ DEFAULT now() NOT NULL\n);\n\nCOMMENT ON TABLE public.audit_logs IS 'Legacy audit logs (public schema) - may be deprecated in favor of main.audit_logs';\n\n-- Table: public.notification_history (legacy, may be duplicated with main.notification_history)\nCREATE TABLE IF NOT EXISTS public.notification_history (\n    id UUID DEFAULT gen_random_uuid() NOT NULL PRIMARY KEY,\n    tenant_id UUID NOT NULL,\n    workflow_id VARCHAR(255) NOT NULL,\n    workflow_name VARCHAR(255),\n    subscriber_id VARCHAR(255) NOT NULL,\n    channel VARCHAR(50) NOT NULL CHECK (channel IN ('email', 'sms', 'push', 'in_app', 'webhook')),\n    status VARCHAR(50) DEFAULT 'pending'::VARCHAR NOT NULL\n        CHECK (status IN ('pending', 'sent', 'delivered', 'failed', 'bounced', 'opened', 'clicked')),\n    recipient_email VARCHAR(255),\n    recipient_phone VARCHAR(50),\n    subject VARCHAR(500),\n    payload JSONB,\n    transaction_id VARCHAR(255),\n    novu_message_id VARCHAR(255),\n    attempts INTEGER DEFAULT 1,\n    error_message TEXT,\n    error_code VARCHAR(100),\n    sent_at TIMESTAMPTZ,\n    delivered_at TIMESTAMPTZ,\n    opened_at TIMESTAMPTZ,\n    clicked_at TIMESTAMPTZ,\n    category VARCHAR(100),\n    metadata JSONB,\n    created_by UUID,\n    modified_by UUID,\n    created_on TIMESTAMPTZ DEFAULT now(),\n    modified_on TIMESTAMPTZ DEFAULT now(),\n    deleted BOOLEAN DEFAULT false,\n    deleted_on TIMESTAMPTZ,\n    deleted_by UUID\n);\n\nCOMMENT ON TABLE public.notification_history IS 'Legacy notification history (public schema) - may be deprecated in favor of main.notification_history';\n\n-- ============================================================================\n-- SECTION 8: SEED DATA\n-- ============================================================================\n\n-- ============================================================================\n-- TENANT SEED DATA (3 tenants - aligned with Supabase organizations)\n-- ============================================================================\n-- UUID Alignment with Supabase:\n--   Arc-SaaS tenant.id = Supabase organization.id\n--   Platform Admin:  a0000000-0000-0000-0000-000000000001\n--   CNS Staff:       a0000000-0000-0000-0000-000000000002\n--   Demo Org:        a0000000-0000-0000-0000-000000000000\n-- ============================================================================\n\n-- Tenant 1: Platform Admin (for super_admin users)\nINSERT INTO main.tenants (\n    id,\n    name,\n    key,\n    status,\n    domains,\n    identity_provider,\n    created_on,\n    modified_on\n) VALUES (\n    'a0000000-0000-0000-0000-000000000001',\n    'Platform Admin',\n    'platform',\n    0,\n    ARRAY['platform.ananta.dev', 'admin.ananta.dev'],\n    'keycloak',\n    NOW(),\n    NOW()\n) ON CONFLICT (id) DO UPDATE SET\n    name = EXCLUDED.name,\n    key = EXCLUDED.key,\n    status = 0,\n    modified_on = NOW();\n\n-- Tenant 2: CNS Staff (for CNS service team)\nINSERT INTO main.tenants (\n    id,\n    name,\n    key,\n    status,\n    domains,\n    identity_provider,\n    created_on,\n    modified_on\n) VALUES (\n    'a0000000-0000-0000-0000-000000000002',\n    'CNS Staff',\n    'cns-staff',\n    0,\n    ARRAY['cns.ananta.dev'],\n    'keycloak',\n    NOW(),\n    NOW()\n) ON CONFLICT (id) DO UPDATE SET\n    name = EXCLUDED.name,\n    key = EXCLUDED.key,\n    status = 0,\n    modified_on = NOW();\n\n-- Tenant 3: Demo Organization (for demo/trial users)\nINSERT INTO main.tenants (\n    id,\n    name,\n    key,\n    status,\n    domains,\n    identity_provider,\n    created_on,\n    modified_on\n) VALUES (\n    'a0000000-0000-0000-0000-000000000000',\n    'Demo Organization',\n    'demo-org',\n    0,\n    ARRAY['demo.ananta.dev'],\n    'keycloak',\n    NOW(),\n    NOW()\n) ON CONFLICT (id) DO UPDATE SET\n    name = EXCLUDED.name,\n    key = EXCLUDED.key,\n    status = 0,\n    modified_on = NOW();\n\n-- ============================================================================\n-- CONTACT SEED DATA (Primary contacts for each tenant)\n-- ============================================================================\n\n-- Contact 1: Platform Admin primary contact\nINSERT INTO main.contacts (\n    id,\n    first_name,\n    last_name,\n    email,\n    is_primary,\n    tenant_id,\n    created_on\n) VALUES (\n    'c0000000-0000-0000-0000-000000000001',\n    'Platform',\n    'Admin',\n    'superadmin@ananta.dev',\n    TRUE,\n    'a0000000-0000-0000-0000-000000000001',\n    NOW()\n) ON CONFLICT (id) DO NOTHING;\n\n-- Contact 2: CNS Staff primary contact\nINSERT INTO main.contacts (\n    id,\n    first_name,\n    last_name,\n    email,\n    is_primary,\n    tenant_id,\n    created_on\n) VALUES (\n    'c0000000-0000-0000-0000-000000000002',\n    'CNS',\n    'Lead',\n    'cns-lead@ananta.dev',\n    TRUE,\n    'a0000000-0000-0000-0000-000000000002',\n    NOW()\n) ON CONFLICT (id) DO NOTHING;\n\n-- Contact 3: Demo Org primary contact\nINSERT INTO main.contacts (\n    id,\n    first_name,\n    last_name,\n    email,\n    is_primary,\n    tenant_id,\n    created_on\n) VALUES (\n    'c0000000-0000-0000-0000-000000000003',\n    'Demo',\n    'Owner',\n    'demo-owner@example.com',\n    TRUE,\n    'a0000000-0000-0000-0000-000000000000',\n    NOW()\n) ON CONFLICT (id) DO NOTHING;\n\n-- Seed: Platform Configuration\nINSERT INTO main.settings (\n    config_key,\n    config_value,\n    value_type,\n    description,\n    category,\n    is_public\n) VALUES\n    (\n        'platform.super_admin_tenant_id',\n        'a0000000-0000-0000-0000-000000000001',\n        'string',\n        'The tenant ID for the Platform Super Admin organization. This is a system tenant for platform administration.',\n        'platform',\n        FALSE\n    ),\n    (\n        'platform.name',\n        'Ananta Platform SaaS',\n        'string',\n        'Platform name displayed in UI',\n        'general',\n        TRUE\n    ),\n    (\n        'platform.version',\n        '1.0.0',\n        'string',\n        'Platform version',\n        'general',\n        TRUE\n    )\nON CONFLICT (config_key) DO UPDATE SET\n    config_value = EXCLUDED.config_value,\n    description = EXCLUDED.description;\n\n-- Seed: Default Plans\nINSERT INTO main.plans (\n    id,\n    name,\n    description,\n    tier,\n    price,\n    billing_cycle,\n    features,\n    is_active,\n    limits,\n    trial_enabled,\n    trial_duration,\n    trial_duration_unit,\n    is_popular,\n    sort_order,\n    created_on,\n    modified_on\n) VALUES\n    (\n        'plan-free',\n        'Free',\n        'Get started for free - perfect for personal projects',\n        'FREE',\n        0.00,\n        'month',\n        '[\"1 user\", \"1 GB storage\", \"Community support\", \"Basic analytics\"]'::jsonb,\n        TRUE,\n        '{\"maxUsers\": 1, \"maxStorage\": 1, \"maxApiCalls\": 1000, \"maxProjects\": 3}'::jsonb,\n        FALSE,\n        14,\n        'days',\n        FALSE,\n        0,\n        NOW(),\n        NOW()\n    ),\n    (\n        'plan-basic',\n        'Basic',\n        'Perfect for small teams getting started',\n        'BASIC',\n        29.00,\n        'month',\n        '[\"Up to 5 users\", \"10 GB storage\", \"Email support\", \"Basic analytics\", \"API access\"]'::jsonb,\n        TRUE,\n        '{\"maxUsers\": 5, \"maxStorage\": 10, \"maxApiCalls\": 10000, \"maxProjects\": 10}'::jsonb,\n        FALSE,\n        14,\n        'days',\n        FALSE,\n        1,\n        NOW(),\n        NOW()\n    ),\n    (\n        'plan-standard',\n        'Standard',\n        'Best for growing businesses',\n        'STANDARD',\n        79.00,\n        'month',\n        '[\"Up to 25 users\", \"100 GB storage\", \"Priority email support\", \"Advanced analytics\", \"API access\", \"Custom integrations\", \"SSO authentication\"]'::jsonb,\n        TRUE,\n        '{\"maxUsers\": 25, \"maxStorage\": 100, \"maxApiCalls\": 100000, \"maxProjects\": 50}'::jsonb,\n        FALSE,\n        14,\n        'days',\n        TRUE,\n        2,\n        NOW(),\n        NOW()\n    ),\n    (\n        'plan-premium',\n        'Premium',\n        'For enterprises with advanced needs',\n        'PREMIUM',\n        199.00,\n        'month',\n        '[\"Unlimited users\", \"1 TB storage\", \"24/7 phone \u0026 email support\", \"Enterprise analytics\", \"Unlimited API access\", \"Custom integrations\", \"SSO authentication\", \"Dedicated account manager\", \"Custom SLA\", \"On-premise deployment option\"]'::jsonb,\n        TRUE,\n        '{\"maxUsers\": null, \"maxStorage\": 1000, \"maxApiCalls\": null, \"maxProjects\": null}'::jsonb,\n        FALSE,\n        14,\n        'days',\n        FALSE,\n        3,\n        NOW(),\n        NOW()\n    )\nON CONFLICT (id) DO UPDATE SET\n    name = EXCLUDED.name,\n    description = EXCLUDED.description,\n    price = EXCLUDED.price,\n    features = EXCLUDED.features,\n    limits = EXCLUDED.limits,\n    is_popular = EXCLUDED.is_popular,\n    modified_on = NOW();\n\n-- Seed: Feature Flags\nINSERT INTO main.feature_flags (name, enabled, description) VALUES\n    ('workflows', TRUE, 'Enable Temporal workflow management'),\n    ('billing', TRUE, 'Enable billing and payment features'),\n    ('auditLogs', TRUE, 'Enable audit log viewing'),\n    ('monitoring', TRUE, 'Enable system monitoring dashboards'),\n    ('notifications', TRUE, 'Enable notification system'),\n    ('quotas', TRUE, 'Enable usage quotas and limits')\nON CONFLICT (name) DO UPDATE SET\n    enabled = EXCLUDED.enabled,\n    description = EXCLUDED.description;\n\n-- ============================================================================\n-- USER SEED DATA (5 users - aligned with Supabase users)\n-- ============================================================================\n-- UUID Alignment with Supabase:\n--   Arc-SaaS user.id = Supabase user.id\n--   All users match keycloak_user_id for SSO\n-- ============================================================================\n\n-- User 1: Platform Super Admin (super_admin role)\nINSERT INTO main.users (\n    id,\n    tenant_id,\n    first_name,\n    last_name,\n    email,\n    status,\n    role,\n    is_active,\n    permissions,\n    keycloak_user_id,\n    created_on,\n    modified_on\n) VALUES (\n    'c0000000-0000-0000-0000-000000000001',\n    'a0000000-0000-0000-0000-000000000001',\n    'Platform',\n    'Admin',\n    'superadmin@ananta.dev',\n    0,\n    'super_admin',\n    TRUE,\n    '[\"*\"]'::jsonb,\n    'superadmin@ananta.dev',\n    NOW(),\n    NOW()\n) ON CONFLICT (id) DO UPDATE SET\n    email = EXCLUDED.email,\n    role = EXCLUDED.role,\n    permissions = EXCLUDED.permissions,\n    modified_on = NOW();\n\n-- User 2: CNS Lead (owner role for CNS Staff org)\nINSERT INTO main.users (\n    id,\n    tenant_id,\n    first_name,\n    last_name,\n    email,\n    status,\n    role,\n    is_active,\n    permissions,\n    keycloak_user_id,\n    created_on,\n    modified_on\n) VALUES (\n    'c0000000-0000-0000-0000-000000000002',\n    'a0000000-0000-0000-0000-000000000002',\n    'CNS',\n    'Lead',\n    'cns-lead@ananta.dev',\n    0,\n    'owner',\n    TRUE,\n    '[\"tenant:*\", \"subscription:*\", \"user:*\"]'::jsonb,\n    'cns-lead@ananta.dev',\n    NOW(),\n    NOW()\n) ON CONFLICT (id) DO UPDATE SET\n    email = EXCLUDED.email,\n    role = EXCLUDED.role,\n    permissions = EXCLUDED.permissions,\n    modified_on = NOW();\n\n-- User 3: CNS Engineer (engineer role for CNS Staff org)\nINSERT INTO main.users (\n    id,\n    tenant_id,\n    first_name,\n    last_name,\n    email,\n    status,\n    role,\n    is_active,\n    permissions,\n    keycloak_user_id,\n    created_on,\n    modified_on\n) VALUES (\n    'c0000000-0000-0000-0000-000000000003',\n    'a0000000-0000-0000-0000-000000000002',\n    'CNS',\n    'Engineer',\n    'cns-engineer@ananta.dev',\n    0,\n    'engineer',\n    TRUE,\n    '[\"component:*\", \"bom:*\", \"enrichment:*\"]'::jsonb,\n    'cns-engineer@ananta.dev',\n    NOW(),\n    NOW()\n) ON CONFLICT (id) DO UPDATE SET\n    email = EXCLUDED.email,\n    role = EXCLUDED.role,\n    permissions = EXCLUDED.permissions,\n    modified_on = NOW();\n\n-- User 4: Demo Owner (owner role for Demo org)\nINSERT INTO main.users (\n    id,\n    tenant_id,\n    first_name,\n    last_name,\n    email,\n    status,\n    role,\n    is_active,\n    permissions,\n    keycloak_user_id,\n    created_on,\n    modified_on\n) VALUES (\n    'c0000000-0000-0000-0000-000000000004',\n    'a0000000-0000-0000-0000-000000000000',\n    'Demo',\n    'Owner',\n    'demo-owner@example.com',\n    0,\n    'owner',\n    TRUE,\n    '[\"tenant:read\", \"tenant:update\", \"user:*\"]'::jsonb,\n    'demo-owner@example.com',\n    NOW(),\n    NOW()\n) ON CONFLICT (id) DO UPDATE SET\n    email = EXCLUDED.email,\n    role = EXCLUDED.role,\n    permissions = EXCLUDED.permissions,\n    modified_on = NOW();\n\n-- User 5: Demo Engineer (engineer role for Demo org)\nINSERT INTO main.users (\n    id,\n    tenant_id,\n    first_name,\n    last_name,\n    email,\n    status,\n    role,\n    is_active,\n    permissions,\n    keycloak_user_id,\n    created_on,\n    modified_on\n) VALUES (\n    'c0000000-0000-0000-0000-000000000005',\n    'a0000000-0000-0000-0000-000000000000',\n    'Demo',\n    'Engineer',\n    'demo-engineer@example.com',\n    0,\n    'engineer',\n    TRUE,\n    '[\"component:read\", \"bom:*\"]'::jsonb,\n    'demo-engineer@example.com',\n    NOW(),\n    NOW()\n) ON CONFLICT (id) DO UPDATE SET\n    email = EXCLUDED.email,\n    role = EXCLUDED.role,\n    permissions = EXCLUDED.permissions,\n    modified_on = NOW();\n\n-- ============================================================================\n-- USER ROLE ASSIGNMENTS\n-- ============================================================================\n\n-- Super Admin role assignment\nINSERT INTO main.user_roles (\n    id,\n    user_id,\n    role_key,\n    tenant_id,\n    created_on\n) VALUES (\n    'd0000000-0000-0000-0000-000000000001',\n    'c0000000-0000-0000-0000-000000000001',\n    'super_admin',\n    'a0000000-0000-0000-0000-000000000001',\n    NOW()\n) ON CONFLICT (id) DO NOTHING;\n\n-- CNS Lead role assignment\nINSERT INTO main.user_roles (\n    id,\n    user_id,\n    role_key,\n    tenant_id,\n    created_on\n) VALUES (\n    'd0000000-0000-0000-0000-000000000002',\n    'c0000000-0000-0000-0000-000000000002',\n    'owner',\n    'a0000000-0000-0000-0000-000000000002',\n    NOW()\n) ON CONFLICT (id) DO NOTHING;\n\n-- CNS Engineer role assignment\nINSERT INTO main.user_roles (\n    id,\n    user_id,\n    role_key,\n    tenant_id,\n    created_on\n) VALUES (\n    'd0000000-0000-0000-0000-000000000003',\n    'c0000000-0000-0000-0000-000000000003',\n    'engineer',\n    'a0000000-0000-0000-0000-000000000002',\n    NOW()\n) ON CONFLICT (id) DO NOTHING;\n\n-- Demo Owner role assignment\nINSERT INTO main.user_roles (\n    id,\n    user_id,\n    role_key,\n    tenant_id,\n    created_on\n) VALUES (\n    'd0000000-0000-0000-0000-000000000004',\n    'c0000000-0000-0000-0000-000000000004',\n    'owner',\n    'a0000000-0000-0000-0000-000000000000',\n    NOW()\n) ON CONFLICT (id) DO NOTHING;\n\n-- Demo Engineer role assignment\nINSERT INTO main.user_roles (\n    id,\n    user_id,\n    role_key,\n    tenant_id,\n    created_on\n) VALUES (\n    'd0000000-0000-0000-0000-000000000005',\n    'c0000000-0000-0000-0000-000000000005',\n    'engineer',\n    'a0000000-0000-0000-0000-000000000000',\n    NOW()\n) ON CONFLICT (id) DO NOTHING;\n\n-- ============================================================================\n-- SUBSCRIPTION SEED DATA (Active subscriptions for all tenants)\n-- ============================================================================\n\n-- Subscription 1: Platform Admin - Premium (unlimited)\nINSERT INTO main.subscriptions (\n    id,\n    tenant_id,\n    planid,\n    planname,\n    plantier,\n    status,\n    amount,\n    current_period_start,\n    current_period_end,\n    created_on,\n    modified_on\n) VALUES (\n    'e0000000-0000-0000-0000-000000000001',\n    'a0000000-0000-0000-0000-000000000001',\n    'plan-premium',\n    'Premium',\n    'premium',\n    'active',\n    199.00,\n    NOW(),\n    NOW() + INTERVAL '100 years',\n    NOW(),\n    NOW()\n) ON CONFLICT (id) DO UPDATE SET\n    status = 'active',\n    modified_on = NOW();\n\n-- Subscription 2: CNS Staff - Premium (unlimited)\nINSERT INTO main.subscriptions (\n    id,\n    tenant_id,\n    planid,\n    planname,\n    plantier,\n    status,\n    amount,\n    current_period_start,\n    current_period_end,\n    created_on,\n    modified_on\n) VALUES (\n    'e0000000-0000-0000-0000-000000000002',\n    'a0000000-0000-0000-0000-000000000002',\n    'plan-premium',\n    'Premium',\n    'premium',\n    'active',\n    199.00,\n    NOW(),\n    NOW() + INTERVAL '100 years',\n    NOW(),\n    NOW()\n) ON CONFLICT (id) DO UPDATE SET\n    status = 'active',\n    modified_on = NOW();\n\n-- Subscription 3: Demo Org - Standard (trial)\nINSERT INTO main.subscriptions (\n    id,\n    tenant_id,\n    planid,\n    planname,\n    plantier,\n    status,\n    amount,\n    trial_start,\n    trial_end,\n    current_period_start,\n    current_period_end,\n    created_on,\n    modified_on\n) VALUES (\n    'e0000000-0000-0000-0000-000000000003',\n    'a0000000-0000-0000-0000-000000000000',\n    'plan-standard',\n    'Standard',\n    'standard',\n    'trialing',\n    79.00,\n    NOW(),\n    NOW() + INTERVAL '14 days',\n    NOW(),\n    NOW() + INTERVAL '1 month',\n    NOW(),\n    NOW()\n) ON CONFLICT (id) DO UPDATE SET\n    status = 'trialing',\n    trial_end = NOW() + INTERVAL '14 days',\n    modified_on = NOW();\n\n-- ============================================================================\n-- TENANT QUOTA SEED DATA (using flexible metric_type schema)\n-- ============================================================================\n\n-- Quota for Platform Admin - Users (unlimited)\nINSERT INTO main.tenant_quotas (\n    id, tenant_id, metric_type, metric_name, soft_limit, hard_limit, current_usage\n) VALUES (\n    'f0000000-0000-0000-0000-000000000001',\n    'a0000000-0000-0000-0000-000000000001',\n    'users', 'User Accounts', 999999, 999999, 1\n) ON CONFLICT (id) DO NOTHING;\n\n-- Quota for CNS Staff - Users (unlimited)\nINSERT INTO main.tenant_quotas (\n    id, tenant_id, metric_type, metric_name, soft_limit, hard_limit, current_usage\n) VALUES (\n    'f0000000-0000-0000-0000-000000000002',\n    'a0000000-0000-0000-0000-000000000002',\n    'users', 'User Accounts', 999999, 999999, 2\n) ON CONFLICT (id) DO NOTHING;\n\n-- Quota for Demo Org - Users (Standard plan: 25 users)\nINSERT INTO main.tenant_quotas (\n    id, tenant_id, metric_type, metric_name, soft_limit, hard_limit, current_usage\n) VALUES (\n    'f0000000-0000-0000-0000-000000000003',\n    'a0000000-0000-0000-0000-000000000000',\n    'users', 'User Accounts', 20, 25, 2\n) ON CONFLICT (id) DO NOTHING;\n\nCOMMIT;\n\n-- ============================================================================\n-- MIGRATION COMPLETE\n-- ============================================================================\n-- Summary:\n-- - Schemas: main, subscription, public\n-- - Main schema tables: 23 (addresses, tenants, leads, contacts, branding_metadata,\n--   users, user_roles, user_invitations, user_activities, audit_logs, plans,\n--   subscriptions, invoices, payment_methods, payment_intents, settings, resources,\n--   platform_config, feature_flags, notification_history, tenant_quotas,\n--   usage_events, usage_summaries)\n-- - Subscription schema tables: 3 (plans, subscriptions, invoices)\n-- - Public schema tables: 4 (migrations, migrations_state, audit_logs, notification_history)\n-- - Custom types: 2 (billing_interval, subscription_status)\n-- - Functions: 4 (create_tenant_schema, drop_tenant_schema in main and public)\n-- - Extensions: 2 (uuid-ossp, pgcrypto)\n--\n-- SEED DATA (out-of-box ready):\n-- - Tenants: 3 (Platform Admin, CNS Staff, Demo Org) - UUID aligned with Supabase\n-- - Contacts: 3 (one primary contact per tenant)\n-- - Users: 5 (super_admin, 2x owner, 2x engineer) - UUID aligned with Supabase\n-- - User Roles: 5 role assignments\n-- - Plans: 4 (Free, Basic, Standard, Premium)\n-- - Subscriptions: 3 (Premium for internal orgs, Standard trial for demo)\n-- - Quotas: 3 (unlimited for internal, limits for demo)\n-- - Feature Flags: 6 (all enabled)\n-- - Platform Settings: 3\n--\n-- UUID ALIGNMENT WITH SUPABASE:\n-- - tenant.id = organization.id\n-- - user.id matches across both databases\n-- - Platform Admin: a0000000-0000-0000-0000-000000000001\n-- - CNS Staff:      a0000000-0000-0000-0000-000000000002\n-- - Demo Org:       a0000000-0000-0000-0000-000000000000\n--\n-- Total verified tables: 30 (matches live database)\n-- ============================================================================\n"
            },
            "id": "database-system/ananta-db-migrations",
            "immutable": false,
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "ananta-db-migrations",
                "namespace": "database-system",
                "resource_version": "21405",
                "uid": "abcf3761-9984-4d36-b1d4-242d350297d3"
              }
            ]
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "ConfigMap",
            "name": "ananta-db-migrations",
            "namespace": "database-system"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "kubernetes_namespace.namespaces"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "kubernetes_config_map",
      "name": "keycloak_realm",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "binary_data": {},
            "data": {
              "arc-saas-realm.json": "{\n  \"realm\": \"arc-saas\",\n  \"enabled\": true,\n  \"displayName\": \"ARC SaaS Platform\",\n  \"displayNameHtml\": \"\u003cdiv class=\\\"kc-logo-text\\\"\u003e\u003cspan\u003eARC SaaS\u003c/span\u003e\u003c/div\u003e\",\n  \"sslRequired\": \"external\",\n  \"registrationAllowed\": false,\n  \"loginWithEmailAllowed\": true,\n  \"duplicateEmailsAllowed\": false,\n  \"resetPasswordAllowed\": true,\n  \"editUsernameAllowed\": false,\n  \"bruteForceProtected\": true,\n  \"permanentLockout\": false,\n  \"maxFailureWaitSeconds\": 900,\n  \"minimumQuickLoginWaitSeconds\": 60,\n  \"waitIncrementSeconds\": 60,\n  \"quickLoginCheckMilliSeconds\": 1000,\n  \"maxDeltaTimeSeconds\": 43200,\n  \"failureFactor\": 5,\n  \"defaultSignatureAlgorithm\": \"RS256\",\n  \"accessTokenLifespan\": 300,\n  \"accessTokenLifespanForImplicitFlow\": 900,\n  \"ssoSessionIdleTimeout\": 1800,\n  \"ssoSessionMaxLifespan\": 36000,\n  \"offlineSessionIdleTimeout\": 2592000,\n  \"accessCodeLifespan\": 60,\n  \"accessCodeLifespanUserAction\": 300,\n  \"accessCodeLifespanLogin\": 1800,\n  \"actionTokenGeneratedByAdminLifespan\": 43200,\n  \"actionTokenGeneratedByUserLifespan\": 300,\n  \"roles\": {\n    \"realm\": [\n      {\n        \"name\": \"super_admin\",\n        \"description\": \"Platform administrator with full access\",\n        \"composite\": false,\n        \"clientRole\": false\n      },\n      {\n        \"name\": \"owner\",\n        \"description\": \"Organization owner with billing access\",\n        \"composite\": false,\n        \"clientRole\": false\n      },\n      {\n        \"name\": \"admin\",\n        \"description\": \"Organization admin for user management\",\n        \"composite\": false,\n        \"clientRole\": false\n      },\n      {\n        \"name\": \"engineer\",\n        \"description\": \"Technical user for managing BOMs and components\",\n        \"composite\": false,\n        \"clientRole\": false\n      },\n      {\n        \"name\": \"analyst\",\n        \"description\": \"Read-only user for viewing data and reports\",\n        \"composite\": false,\n        \"clientRole\": false\n      }\n    ],\n    \"client\": {\n      \"arc-saas-admin\": [\n        {\n          \"name\": \"manage-realm\",\n          \"description\": \"Manage realm configuration\",\n          \"composite\": false,\n          \"clientRole\": true\n        }\n      ]\n    }\n  },\n  \"groups\": [\n    {\n      \"name\": \"Platform Admins\",\n      \"path\": \"/Platform Admins\",\n      \"realmRoles\": [\"super_admin\"]\n    },\n    {\n      \"name\": \"Organization Owners\",\n      \"path\": \"/Organization Owners\",\n      \"realmRoles\": [\"owner\"]\n    }\n  ],\n  \"clients\": [\n    {\n      \"clientId\": \"arc-saas-admin\",\n      \"name\": \"ARC SaaS Admin Portal\",\n      \"description\": \"Admin application for platform management\",\n      \"enabled\": true,\n      \"publicClient\": true,\n      \"standardFlowEnabled\": true,\n      \"implicitFlowEnabled\": false,\n      \"directAccessGrantsEnabled\": true,\n      \"serviceAccountsEnabled\": false,\n      \"authorizationServicesEnabled\": false,\n      \"fullScopeAllowed\": true,\n      \"rootUrl\": \"http://localhost:27555\",\n      \"baseUrl\": \"/\",\n      \"adminUrl\": \"\",\n      \"redirectUris\": [\n        \"http://localhost:27555/*\",\n        \"http://localhost:14000/*\",\n        \"http://localhost:3000/*\"\n      ],\n      \"webOrigins\": [\n        \"http://localhost:27555\",\n        \"http://localhost:14000\",\n        \"http://localhost:3000\"\n      ],\n      \"defaultClientScopes\": [\n        \"web-origins\",\n        \"acr\",\n        \"profile\",\n        \"roles\",\n        \"email\"\n      ],\n      \"optionalClientScopes\": [\n        \"address\",\n        \"phone\",\n        \"offline_access\",\n        \"microprofile-jwt\"\n      ],\n      \"protocolMappers\": [\n        {\n          \"name\": \"tenant-id-mapper\",\n          \"protocol\": \"openid-connect\",\n          \"protocolMapper\": \"oidc-usermodel-attribute-mapper\",\n          \"consentRequired\": false,\n          \"config\": {\n            \"userinfo.token.claim\": \"true\",\n            \"user.attribute\": \"tenant_id\",\n            \"id.token.claim\": \"true\",\n            \"access.token.claim\": \"true\",\n            \"claim.name\": \"tenant_id\",\n            \"jsonType.label\": \"String\"\n          }\n        }\n      ]\n    },\n    {\n      \"clientId\": \"arc-saas-api\",\n      \"name\": \"ARC SaaS Backend API\",\n      \"description\": \"Backend API service\",\n      \"enabled\": true,\n      \"publicClient\": false,\n      \"bearerOnly\": true,\n      \"standardFlowEnabled\": false,\n      \"implicitFlowEnabled\": false,\n      \"directAccessGrantsEnabled\": false,\n      \"serviceAccountsEnabled\": false,\n      \"fullScopeAllowed\": true\n    },\n    {\n      \"clientId\": \"arc-saas-customer-portal\",\n      \"name\": \"Customer Portal\",\n      \"description\": \"Customer-facing portal\",\n      \"enabled\": true,\n      \"publicClient\": true,\n      \"standardFlowEnabled\": true,\n      \"directAccessGrantsEnabled\": true,\n      \"rootUrl\": \"http://localhost:27100\",\n      \"redirectUris\": [\n        \"http://localhost:27100/*\"\n      ],\n      \"webOrigins\": [\n        \"http://localhost:27100\"\n      ],\n      \"defaultClientScopes\": [\n        \"web-origins\",\n        \"acr\",\n        \"profile\",\n        \"roles\",\n        \"email\"\n      ]\n    }\n  ],\n  \"clientScopes\": [\n    {\n      \"name\": \"roles\",\n      \"description\": \"OpenID Connect scope for add user roles to the access token\",\n      \"protocol\": \"openid-connect\",\n      \"attributes\": {\n        \"include.in.token.scope\": \"true\",\n        \"display.on.consent.screen\": \"true\",\n        \"consent.screen.text\": \"${rolesScopeConsentText}\"\n      },\n      \"protocolMappers\": [\n        {\n          \"name\": \"realm roles\",\n          \"protocol\": \"openid-connect\",\n          \"protocolMapper\": \"oidc-usermodel-realm-role-mapper\",\n          \"consentRequired\": false,\n          \"config\": {\n            \"multivalued\": \"true\",\n            \"userinfo.token.claim\": \"true\",\n            \"id.token.claim\": \"true\",\n            \"access.token.claim\": \"true\",\n            \"claim.name\": \"realm_access.roles\",\n            \"jsonType.label\": \"String\"\n          }\n        },\n        {\n          \"name\": \"client roles\",\n          \"protocol\": \"openid-connect\",\n          \"protocolMapper\": \"oidc-usermodel-client-role-mapper\",\n          \"consentRequired\": false,\n          \"config\": {\n            \"multivalued\": \"true\",\n            \"userinfo.token.claim\": \"true\",\n            \"id.token.claim\": \"true\",\n            \"access.token.claim\": \"true\",\n            \"claim.name\": \"resource_access.${client_id}.roles\",\n            \"jsonType.label\": \"String\"\n          }\n        }\n      ]\n    },\n    {\n      \"name\": \"tenant\",\n      \"description\": \"Tenant context scope\",\n      \"protocol\": \"openid-connect\",\n      \"attributes\": {\n        \"include.in.token.scope\": \"true\",\n        \"display.on.consent.screen\": \"false\"\n      },\n      \"protocolMappers\": [\n        {\n          \"name\": \"tenant_id\",\n          \"protocol\": \"openid-connect\",\n          \"protocolMapper\": \"oidc-usermodel-attribute-mapper\",\n          \"consentRequired\": false,\n          \"config\": {\n            \"userinfo.token.claim\": \"true\",\n            \"user.attribute\": \"tenant_id\",\n            \"id.token.claim\": \"true\",\n            \"access.token.claim\": \"true\",\n            \"claim.name\": \"tenant_id\",\n            \"jsonType.label\": \"String\"\n          }\n        },\n        {\n          \"name\": \"tenant_key\",\n          \"protocol\": \"openid-connect\",\n          \"protocolMapper\": \"oidc-usermodel-attribute-mapper\",\n          \"consentRequired\": false,\n          \"config\": {\n            \"userinfo.token.claim\": \"true\",\n            \"user.attribute\": \"tenant_key\",\n            \"id.token.claim\": \"true\",\n            \"access.token.claim\": \"true\",\n            \"claim.name\": \"tenant_key\",\n            \"jsonType.label\": \"String\"\n          }\n        }\n      ]\n    }\n  ],\n  \"users\": [\n    {\n      \"username\": \"platform-admin\",\n      \"email\": \"admin@arc-saas.local\",\n      \"enabled\": true,\n      \"emailVerified\": true,\n      \"firstName\": \"Platform\",\n      \"lastName\": \"Admin\",\n      \"credentials\": [\n        {\n          \"type\": \"password\",\n          \"value\": \"admin123\",\n          \"temporary\": true\n        }\n      ],\n      \"realmRoles\": [\"super_admin\"],\n      \"groups\": [\"/Platform Admins\"],\n      \"attributes\": {\n        \"tenant_id\": [\"system\"],\n        \"tenant_key\": [\"system\"]\n      }\n    },\n    {\n      \"username\": \"demo.user\",\n      \"email\": \"demo@example.com\",\n      \"enabled\": true,\n      \"emailVerified\": true,\n      \"firstName\": \"Demo\",\n      \"lastName\": \"User\",\n      \"credentials\": [\n        {\n          \"type\": \"password\",\n          \"value\": \"demo123\",\n          \"temporary\": false\n        }\n      ],\n      \"realmRoles\": [\"admin\"],\n      \"attributes\": {\n        \"tenant_id\": [\"demo\"],\n        \"tenant_key\": [\"demo\"]\n      }\n    }\n  ],\n  \"identityProviders\": [],\n  \"components\": {\n    \"org.keycloak.keys.KeyProvider\": [\n      {\n        \"name\": \"rsa-generated\",\n        \"providerId\": \"rsa-generated\",\n        \"subComponents\": {},\n        \"config\": {\n          \"priority\": [\"100\"],\n          \"keySize\": [\"2048\"]\n        }\n      },\n      {\n        \"name\": \"hmac-generated\",\n        \"providerId\": \"hmac-generated\",\n        \"subComponents\": {},\n        \"config\": {\n          \"priority\": [\"100\"],\n          \"algorithm\": [\"HS256\"]\n        }\n      }\n    ]\n  },\n  \"browserSecurityHeaders\": {\n    \"contentSecurityPolicyReportOnly\": \"\",\n    \"xContentTypeOptions\": \"nosniff\",\n    \"xRobotsTag\": \"none\",\n    \"xFrameOptions\": \"SAMEORIGIN\",\n    \"contentSecurityPolicy\": \"frame-src 'self'; frame-ancestors 'self'; object-src 'none';\",\n    \"xXSSProtection\": \"1; mode=block\",\n    \"strictTransportSecurity\": \"max-age=31536000; includeSubDomains\"\n  }\n}\n"
            },
            "id": "auth-system/ananta-keycloak-realm",
            "immutable": false,
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "ananta-keycloak-realm",
                "namespace": "auth-system",
                "resource_version": "21404",
                "uid": "a913af9a-1c99-4bce-a7ae-cbdb821ad90b"
              }
            ]
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "ConfigMap",
            "name": "ananta-keycloak-realm",
            "namespace": "auth-system"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "kubernetes_namespace.namespaces"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "kubernetes_namespace",
      "name": "namespaces",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "index_key": "auth",
          "schema_version": 0,
          "attributes": {
            "id": "auth-system",
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "auth",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "auth-system",
                "resource_version": "21388",
                "uid": "c739b208-b517-4ffc-98fe-8e8f56f67c9e"
              }
            ],
            "timeouts": null,
            "wait_for_default_service_account": false
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Namespace",
            "name": "auth-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiZGVsZXRlIjozMDAwMDAwMDAwMDB9fQ=="
        },
        {
          "index_key": "cache",
          "schema_version": 0,
          "attributes": {
            "id": "cache-system",
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "cache",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "cache-system",
                "resource_version": "21390",
                "uid": "d36d38e4-9829-4f92-a92f-fafe8165357d"
              }
            ],
            "timeouts": null,
            "wait_for_default_service_account": false
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Namespace",
            "name": "cache-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiZGVsZXRlIjozMDAwMDAwMDAwMDB9fQ=="
        },
        {
          "index_key": "control_plane",
          "schema_version": 0,
          "attributes": {
            "id": "control-plane",
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "control_plane",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "control-plane",
                "resource_version": "21389",
                "uid": "b7b92070-f299-4b74-82d6-45f4342ae4f3"
              }
            ],
            "timeouts": null,
            "wait_for_default_service_account": false
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Namespace",
            "name": "control-plane"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiZGVsZXRlIjozMDAwMDAwMDAwMDB9fQ=="
        },
        {
          "index_key": "database",
          "schema_version": 0,
          "attributes": {
            "id": "database-system",
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "database",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "database-system",
                "resource_version": "21391",
                "uid": "6ace28e7-0a90-4f28-889b-01f412068983"
              }
            ],
            "timeouts": null,
            "wait_for_default_service_account": false
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Namespace",
            "name": "database-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiZGVsZXRlIjozMDAwMDAwMDAwMDB9fQ=="
        },
        {
          "index_key": "monitoring",
          "schema_version": 0,
          "attributes": {
            "id": "monitoring-system",
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "monitoring",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "monitoring-system",
                "resource_version": "21006",
                "uid": "e98be668-ad9d-4f88-a652-b4c9d49ec251"
              }
            ],
            "timeouts": null,
            "wait_for_default_service_account": false
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Namespace",
            "name": "monitoring-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiZGVsZXRlIjozMDAwMDAwMDAwMDB9fQ=="
        },
        {
          "index_key": "temporal",
          "schema_version": 0,
          "attributes": {
            "id": "temporal-system",
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "temporal",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "temporal-system",
                "resource_version": "21392",
                "uid": "e8ca14c3-2af1-4866-9699-6dc8d0f3c8f1"
              }
            ],
            "timeouts": null,
            "wait_for_default_service_account": false
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Namespace",
            "name": "temporal-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiZGVsZXRlIjozMDAwMDAwMDAwMDB9fQ=="
        },
        {
          "index_key": "vault",
          "schema_version": 0,
          "attributes": {
            "id": "vault-system",
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "vault",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "vault-system",
                "resource_version": "21005",
                "uid": "d9e6d660-b5c5-4a9e-8cd5-a15e853119f1"
              }
            ],
            "timeouts": null,
            "wait_for_default_service_account": false
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Namespace",
            "name": "vault-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiZGVsZXRlIjozMDAwMDAwMDAwMDB9fQ=="
        }
      ]
    },
    {
      "module": "module.cache",
      "mode": "managed",
      "type": "helm_release",
      "name": "redis_operator",
      "provider": "provider[\"registry.terraform.io/hashicorp/helm\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 2,
          "attributes": {
            "atomic": false,
            "chart": "redis-operator",
            "cleanup_on_fail": false,
            "create_namespace": true,
            "dependency_update": false,
            "description": null,
            "devel": null,
            "disable_crd_hooks": false,
            "disable_openapi_validation": false,
            "disable_webhooks": false,
            "force_update": false,
            "id": "redis-operator",
            "keyring": null,
            "lint": false,
            "manifest": null,
            "max_history": 0,
            "metadata": {
              "app_version": "1.2.4",
              "chart": "redis-operator",
              "first_deployed": 1767822573,
              "last_deployed": 1767822573,
              "name": "redis-operator",
              "namespace": "redis-operator",
              "notes": "",
              "revision": 1,
              "values": "{\"resources\":{\"limits\":{\"cpu\":\"100m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"50m\",\"memory\":\"64Mi\"}}}",
              "version": "3.2.9"
            },
            "name": "redis-operator",
            "namespace": "redis-operator",
            "pass_credentials": false,
            "postrender": null,
            "recreate_pods": false,
            "render_subchart_notes": true,
            "replace": false,
            "repository": "https://spotahome.github.io/redis-operator",
            "repository_ca_file": null,
            "repository_cert_file": null,
            "repository_key_file": null,
            "repository_password": null,
            "repository_username": null,
            "reset_values": false,
            "resources": null,
            "reuse_values": false,
            "set": null,
            "set_list": null,
            "set_sensitive": null,
            "set_wo": null,
            "set_wo_revision": null,
            "skip_crds": false,
            "status": "deployed",
            "take_ownership": false,
            "timeout": 300,
            "timeouts": null,
            "upgrade_install": false,
            "values": [
              "\"resources\":\n  \"limits\":\n    \"cpu\": \"100m\"\n    \"memory\": \"128Mi\"\n  \"requests\":\n    \"cpu\": \"50m\"\n    \"memory\": \"64Mi\"\n"
            ],
            "verify": false,
            "version": "3.2.9",
            "wait": true,
            "wait_for_jobs": false
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "repository_password"
              }
            ]
          ],
          "identity_schema_version": 0,
          "identity": {
            "namespace": "redis-operator",
            "release_name": "redis-operator"
          },
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.cache.kubernetes_namespace.redis",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.cache",
      "mode": "managed",
      "type": "kubernetes_manifest",
      "name": "prometheus_rules",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": []
    },
    {
      "module": "module.cache",
      "mode": "managed",
      "type": "kubernetes_manifest",
      "name": "redis_failover",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": []
    },
    {
      "module": "module.cache",
      "mode": "managed",
      "type": "kubernetes_manifest",
      "name": "service_monitor",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": []
    },
    {
      "module": "module.cache",
      "mode": "managed",
      "type": "kubernetes_namespace",
      "name": "redis",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": []
    },
    {
      "module": "module.cache",
      "mode": "managed",
      "type": "kubernetes_secret",
      "name": "redis_auth",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "binary_data": null,
            "binary_data_wo": null,
            "binary_data_wo_revision": null,
            "data": {
              "password": "rHQ9xmHIiCuGF5pj7LqmBMd1UrkjJOpR"
            },
            "data_wo": null,
            "data_wo_revision": null,
            "id": "cache-system/ananta-redis-auth",
            "immutable": false,
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "cache",
                  "app.kubernetes.io/instance": "ananta-redis",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "redis",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "ananta-redis-auth",
                "namespace": "cache-system",
                "resource_version": "21763",
                "uid": "e5a748af-cfd7-45ea-8fe0-87b3f46d5202"
              }
            ],
            "timeouts": null,
            "type": "Opaque",
            "wait_for_service_account_token": true
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "binary_data"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "data"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "data"
              },
              {
                "type": "index",
                "value": {
                  "value": "password",
                  "type": "string"
                }
              }
            ]
          ],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Secret",
            "name": "ananta-redis-auth",
            "namespace": "cache-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMH19",
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.cache.kubernetes_namespace.redis",
            "module.cache.random_password.redis_password",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.cache",
      "mode": "managed",
      "type": "kubernetes_service",
      "name": "redis",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 1,
          "attributes": {
            "id": "cache-system/ananta-redis",
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "cache",
                  "app.kubernetes.io/instance": "ananta-redis",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "redis",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "ananta-redis",
                "namespace": "cache-system",
                "resource_version": "21855",
                "uid": "785b8d3d-ec76-48a5-ac02-018e0eac81b7"
              }
            ],
            "spec": [
              {
                "allocate_load_balancer_node_ports": true,
                "cluster_ip": "10.43.25.84",
                "cluster_ips": [
                  "10.43.25.84"
                ],
                "external_ips": [],
                "external_name": "",
                "external_traffic_policy": "",
                "health_check_node_port": 0,
                "internal_traffic_policy": "Cluster",
                "ip_families": [
                  "IPv4"
                ],
                "ip_family_policy": "SingleStack",
                "load_balancer_class": "",
                "load_balancer_ip": "",
                "load_balancer_source_ranges": [],
                "port": [
                  {
                    "app_protocol": "",
                    "name": "redis",
                    "node_port": 0,
                    "port": 6379,
                    "protocol": "TCP",
                    "target_port": "6379"
                  }
                ],
                "publish_not_ready_addresses": false,
                "selector": {
                  "app.kubernetes.io/instance": "ananta-redis",
                  "app.kubernetes.io/name": "redis"
                },
                "session_affinity": "None",
                "session_affinity_config": [],
                "type": "ClusterIP"
              }
            ],
            "status": [
              {
                "load_balancer": [
                  {
                    "ingress": []
                  }
                ]
              }
            ],
            "timeouts": null,
            "wait_for_load_balancer": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Service",
            "name": "ananta-redis",
            "namespace": "cache-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.cache.kubernetes_namespace.redis",
            "module.cache.kubernetes_secret.redis_auth",
            "module.cache.kubernetes_stateful_set.redis_standalone",
            "module.cache.random_password.redis_password",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.cache",
      "mode": "managed",
      "type": "kubernetes_stateful_set",
      "name": "redis_standalone",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 1,
          "attributes": {
            "id": "cache-system/ananta-redis",
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 1,
                "labels": {
                  "app.kubernetes.io/component": "cache",
                  "app.kubernetes.io/instance": "ananta-redis",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "redis",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "ananta-redis",
                "namespace": "cache-system",
                "resource_version": "21853",
                "uid": "1839dba3-79e9-43ce-969e-84953bad10c7"
              }
            ],
            "spec": [
              {
                "min_ready_seconds": 0,
                "persistent_volume_claim_retention_policy": [
                  {
                    "when_deleted": "Retain",
                    "when_scaled": "Retain"
                  }
                ],
                "pod_management_policy": "OrderedReady",
                "replicas": "1",
                "revision_history_limit": 0,
                "selector": [
                  {
                    "match_expressions": [],
                    "match_labels": {
                      "app.kubernetes.io/instance": "ananta-redis",
                      "app.kubernetes.io/name": "redis"
                    }
                  }
                ],
                "service_name": "ananta-redis",
                "template": [
                  {
                    "metadata": [
                      {
                        "annotations": {},
                        "generate_name": "",
                        "generation": 0,
                        "labels": {
                          "app.kubernetes.io/component": "cache",
                          "app.kubernetes.io/instance": "ananta-redis",
                          "app.kubernetes.io/managed-by": "terraform",
                          "app.kubernetes.io/name": "redis",
                          "app.kubernetes.io/part-of": "ananta-platform",
                          "environment": "local"
                        },
                        "name": "",
                        "namespace": "",
                        "resource_version": "",
                        "uid": ""
                      }
                    ],
                    "spec": [
                      {
                        "active_deadline_seconds": 0,
                        "affinity": [],
                        "automount_service_account_token": true,
                        "container": [
                          {
                            "args": [],
                            "command": [
                              "redis-server",
                              "--requirepass",
                              "$(REDIS_PASSWORD)",
                              "--maxmemory-policy",
                              "volatile-lru",
                              "--tcp-keepalive",
                              "300"
                            ],
                            "env": [
                              {
                                "name": "REDIS_PASSWORD",
                                "value": "",
                                "value_from": [
                                  {
                                    "config_map_key_ref": [],
                                    "field_ref": [],
                                    "resource_field_ref": [],
                                    "secret_key_ref": [
                                      {
                                        "key": "password",
                                        "name": "ananta-redis-auth",
                                        "optional": false
                                      }
                                    ]
                                  }
                                ]
                              }
                            ],
                            "env_from": [],
                            "image": "redis:7.0-alpine",
                            "image_pull_policy": "IfNotPresent",
                            "lifecycle": [],
                            "liveness_probe": [
                              {
                                "exec": [
                                  {
                                    "command": [
                                      "redis-cli",
                                      "-a",
                                      "$(REDIS_PASSWORD)",
                                      "ping"
                                    ]
                                  }
                                ],
                                "failure_threshold": 3,
                                "grpc": [],
                                "http_get": [],
                                "initial_delay_seconds": 30,
                                "period_seconds": 10,
                                "success_threshold": 1,
                                "tcp_socket": [],
                                "timeout_seconds": 1
                              }
                            ],
                            "name": "redis",
                            "port": [
                              {
                                "container_port": 6379,
                                "host_ip": "",
                                "host_port": 0,
                                "name": "redis",
                                "protocol": "TCP"
                              }
                            ],
                            "readiness_probe": [
                              {
                                "exec": [
                                  {
                                    "command": [
                                      "redis-cli",
                                      "-a",
                                      "$(REDIS_PASSWORD)",
                                      "ping"
                                    ]
                                  }
                                ],
                                "failure_threshold": 3,
                                "grpc": [],
                                "http_get": [],
                                "initial_delay_seconds": 5,
                                "period_seconds": 5,
                                "success_threshold": 1,
                                "tcp_socket": [],
                                "timeout_seconds": 1
                              }
                            ],
                            "resources": [
                              {
                                "limits": {
                                  "cpu": "200m",
                                  "memory": "256Mi"
                                },
                                "requests": {
                                  "cpu": "200m",
                                  "memory": "256Mi"
                                }
                              }
                            ],
                            "restart_policy": "",
                            "security_context": [],
                            "startup_probe": [],
                            "stdin": false,
                            "stdin_once": false,
                            "termination_message_path": "/dev/termination-log",
                            "termination_message_policy": "File",
                            "tty": false,
                            "volume_device": [],
                            "volume_mount": [
                              {
                                "mount_path": "/data",
                                "mount_propagation": "None",
                                "name": "data",
                                "read_only": false,
                                "sub_path": "",
                                "sub_path_expr": ""
                              }
                            ],
                            "working_dir": ""
                          }
                        ],
                        "dns_config": [],
                        "dns_policy": "ClusterFirst",
                        "enable_service_links": true,
                        "host_aliases": [],
                        "host_ipc": false,
                        "host_network": false,
                        "host_pid": false,
                        "hostname": "",
                        "image_pull_secrets": [],
                        "init_container": [],
                        "node_name": "",
                        "node_selector": {},
                        "os": [],
                        "priority_class_name": "",
                        "readiness_gate": [],
                        "restart_policy": "Always",
                        "runtime_class_name": "",
                        "scheduler_name": "default-scheduler",
                        "security_context": [],
                        "service_account_name": "",
                        "share_process_namespace": false,
                        "subdomain": "",
                        "termination_grace_period_seconds": 30,
                        "toleration": [],
                        "topology_spread_constraint": [],
                        "volume": []
                      }
                    ]
                  }
                ],
                "update_strategy": [],
                "volume_claim_template": [
                  {
                    "metadata": [
                      {
                        "annotations": {},
                        "generate_name": "",
                        "generation": 0,
                        "labels": {},
                        "name": "data",
                        "namespace": "default",
                        "resource_version": "",
                        "uid": ""
                      }
                    ],
                    "spec": [
                      {
                        "access_modes": [
                          "ReadWriteOnce"
                        ],
                        "resources": [
                          {
                            "limits": {},
                            "requests": {
                              "storage": "1Gi"
                            }
                          }
                        ],
                        "selector": [],
                        "storage_class_name": "local-path",
                        "volume_mode": "Filesystem",
                        "volume_name": ""
                      }
                    ]
                  }
                ]
              }
            ],
            "timeouts": null,
            "wait_for_rollout": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "apps/v1",
            "kind": "StatefulSet",
            "name": "ananta-redis",
            "namespace": "cache-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJyZWFkIjo2MDAwMDAwMDAwMDAsInVwZGF0ZSI6NjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.cache.kubernetes_namespace.redis",
            "module.cache.kubernetes_secret.redis_auth",
            "module.cache.random_password.redis_password",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.cache",
      "mode": "managed",
      "type": "random_password",
      "name": "redis_password",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 3,
          "attributes": {
            "bcrypt_hash": "$2a$10$UmV0tE5QIjCW4FFANcS65OKk13rz6bg0Y2gW19o323c259Fpq9zuy",
            "id": "none",
            "keepers": null,
            "length": 32,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": null,
            "result": "rHQ9xmHIiCuGF5pj7LqmBMd1UrkjJOpR",
            "special": false,
            "upper": true
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "bcrypt_hash"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "result"
              }
            ]
          ],
          "identity_schema_version": 0,
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.database",
      "mode": "managed",
      "type": "helm_release",
      "name": "cloudnative_pg",
      "provider": "provider[\"registry.terraform.io/hashicorp/helm\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 2,
          "attributes": {
            "atomic": false,
            "chart": "cloudnative-pg",
            "cleanup_on_fail": false,
            "create_namespace": true,
            "dependency_update": false,
            "description": null,
            "devel": null,
            "disable_crd_hooks": false,
            "disable_openapi_validation": false,
            "disable_webhooks": false,
            "force_update": false,
            "id": "cnpg",
            "keyring": null,
            "lint": false,
            "manifest": null,
            "max_history": 0,
            "metadata": {
              "app_version": "1.21.1",
              "chart": "cloudnative-pg",
              "first_deployed": 1767823074,
              "last_deployed": 1767823074,
              "name": "cnpg",
              "namespace": "cnpg-system",
              "notes": "\nCloudNativePG operator should be installed in namespace \"cnpg-system\".\nYou can now create a PostgreSQL cluster with 3 nodes in the current namespace as follows:\n\ncat \u003c\u003cEOF | kubectl apply -f -\n# Example of PostgreSQL cluster\napiVersion: postgresql.cnpg.io/v1\nkind: Cluster\nmetadata:\n  name: cluster-example\nspec:\n  instances: 3\n  storage:\n    size: 1Gi\nEOF\n\nkubectl get cluster\n\n",
              "revision": 1,
              "values": "{\"monitoring\":{\"podMonitorEnabled\":false},\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"256Mi\"}}}",
              "version": "0.19.1"
            },
            "name": "cnpg",
            "namespace": "cnpg-system",
            "pass_credentials": false,
            "postrender": null,
            "recreate_pods": false,
            "render_subchart_notes": true,
            "replace": false,
            "repository": "https://cloudnative-pg.github.io/charts",
            "repository_ca_file": null,
            "repository_cert_file": null,
            "repository_key_file": null,
            "repository_password": null,
            "repository_username": null,
            "reset_values": false,
            "resources": null,
            "reuse_values": false,
            "set": null,
            "set_list": null,
            "set_sensitive": null,
            "set_wo": null,
            "set_wo_revision": null,
            "skip_crds": false,
            "status": "deployed",
            "take_ownership": false,
            "timeout": 300,
            "timeouts": null,
            "upgrade_install": false,
            "values": [
              "\"monitoring\":\n  \"podMonitorEnabled\": false\n\"resources\":\n  \"limits\":\n    \"cpu\": \"500m\"\n    \"memory\": \"512Mi\"\n  \"requests\":\n    \"cpu\": \"100m\"\n    \"memory\": \"256Mi\"\n"
            ],
            "verify": false,
            "version": "0.19.1",
            "wait": true,
            "wait_for_jobs": false
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "repository_password"
              }
            ]
          ],
          "identity_schema_version": 0,
          "identity": {
            "namespace": "cnpg-system",
            "release_name": "cnpg"
          },
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.database",
      "mode": "managed",
      "type": "kubernetes_namespace",
      "name": "database",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": []
    },
    {
      "module": "module.database",
      "mode": "managed",
      "type": "kubernetes_secret",
      "name": "app_user",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "binary_data": null,
            "binary_data_wo": null,
            "binary_data_wo_revision": null,
            "data": {
              "password": "k6M0XUo9R45h0mMJW_L]P(a0",
              "username": "ananta_app"
            },
            "data_wo": null,
            "data_wo_revision": null,
            "id": "database-system/ananta-local-pg-app",
            "immutable": false,
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "database",
                  "app.kubernetes.io/instance": "ananta-local-pg",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "postgresql",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "ananta-local-pg-app",
                "namespace": "database-system",
                "resource_version": "21764",
                "uid": "ff07bbd6-4ba5-4291-83b3-af47e4fb9108"
              }
            ],
            "timeouts": null,
            "type": "kubernetes.io/basic-auth",
            "wait_for_service_account_token": true
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "binary_data"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "data"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "data"
              },
              {
                "type": "index",
                "value": {
                  "value": "password",
                  "type": "string"
                }
              }
            ]
          ],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Secret",
            "name": "ananta-local-pg-app",
            "namespace": "database-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMH19",
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.kubernetes_namespace.database",
            "module.database.random_password.app_user",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.database",
      "mode": "managed",
      "type": "kubernetes_secret",
      "name": "superuser",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "binary_data": null,
            "binary_data_wo": null,
            "binary_data_wo_revision": null,
            "data": {
              "password": "d#z-)(B+cXteY=}$AlS:34D%",
              "username": "postgres"
            },
            "data_wo": null,
            "data_wo_revision": null,
            "id": "database-system/ananta-local-pg-superuser",
            "immutable": false,
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "database",
                  "app.kubernetes.io/instance": "ananta-local-pg",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "postgresql",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "ananta-local-pg-superuser",
                "namespace": "database-system",
                "resource_version": "21762",
                "uid": "10c2cf00-2d58-4639-a294-d84d4f7d52b4"
              }
            ],
            "timeouts": null,
            "type": "kubernetes.io/basic-auth",
            "wait_for_service_account_token": true
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "binary_data"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "data"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "data"
              },
              {
                "type": "index",
                "value": {
                  "value": "password",
                  "type": "string"
                }
              }
            ]
          ],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Secret",
            "name": "ananta-local-pg-superuser",
            "namespace": "database-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMH19",
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.kubernetes_namespace.database",
            "module.database.random_password.superuser",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.database",
      "mode": "managed",
      "type": "kubernetes_service",
      "name": "database",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": []
    },
    {
      "module": "module.database",
      "mode": "managed",
      "type": "local_file",
      "name": "cluster_manifest",
      "provider": "provider[\"registry.terraform.io/hashicorp/local\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "content": "\"apiVersion\": \"postgresql.cnpg.io/v1\"\n\"kind\": \"Cluster\"\n\"metadata\":\n  \"labels\":\n    \"app.kubernetes.io/component\": \"database\"\n    \"app.kubernetes.io/instance\": \"ananta-local-pg\"\n    \"app.kubernetes.io/managed-by\": \"terraform\"\n    \"app.kubernetes.io/name\": \"postgresql\"\n    \"app.kubernetes.io/part-of\": \"ananta-platform\"\n    \"environment\": \"local\"\n  \"name\": \"ananta-local-pg\"\n  \"namespace\": \"database-system\"\n\"spec\":\n  \"affinity\":\n    \"podAntiAffinityType\": \"preferred\"\n    \"topologyKey\": \"kubernetes.io/hostname\"\n  \"bootstrap\":\n    \"initdb\":\n      \"database\": \"ananta\"\n      \"owner\": \"ananta_app\"\n      \"secret\":\n        \"name\": \"ananta-local-pg-app\"\n  \"description\": \"PostgreSQL cluster for ananta local\"\n  \"imageName\": \"ghcr.io/cloudnative-pg/postgresql:15\"\n  \"instances\": 1\n  \"monitoring\":\n    \"enablePodMonitor\": false\n  \"postgresql\":\n    \"parameters\":\n      \"checkpoint_completion_target\": \"0.9\"\n      \"default_statistics_target\": \"100\"\n      \"effective_cache_size\": \"512MB\"\n      \"effective_io_concurrency\": \"200\"\n      \"log_checkpoints\": \"on\"\n      \"log_connections\": \"on\"\n      \"log_disconnections\": \"on\"\n      \"log_lock_waits\": \"on\"\n      \"maintenance_work_mem\": \"64MB\"\n      \"max_connections\": \"100\"\n      \"max_wal_size\": \"4GB\"\n      \"min_wal_size\": \"1GB\"\n      \"random_page_cost\": \"1.1\"\n      \"shared_buffers\": \"256MB\"\n      \"wal_buffers\": \"16MB\"\n  \"primaryUpdateStrategy\": \"unsupervised\"\n  \"resources\":\n    \"limits\":\n      \"cpu\": \"1\"\n      \"memory\": \"1Gi\"\n    \"requests\":\n      \"cpu\": \"500m\"\n      \"memory\": \"512Mi\"\n  \"storage\":\n    \"size\": \"10Gi\"\n    \"storageClass\": \"local-path\"\n  \"superuserSecret\":\n    \"name\": \"ananta-local-pg-superuser\"\n",
            "content_base64": null,
            "content_base64sha256": "0E0NXWH7hcj69Rg8LtKkhemz6S1h2txloqbAAwcK1dY=",
            "content_base64sha512": "BYr4dj+m3kRc5lWBajoJqaJJt8VUNeQMEVUJw063TqLbiU2ZHRVfrlwGr1A94Z3TofgRBi57a29ZBDRzS8nnNw==",
            "content_md5": "2a40cdcab59302b194623a7634cf6faa",
            "content_sha1": "c26f11e42f946727ddba119fd1420f22e35c3e27",
            "content_sha256": "d04d0d5d61fb85c8faf5183c2ed2a485e9b3e92d61dadc65a2a6c003070ad5d6",
            "content_sha512": "058af8763fa6de445ce655816a3a09a9a249b7c55435e40c115509c34eb74ea2db894d991d155fae5c06af503de19dd3a1f811062e7b6b6f590434734bc9e737",
            "directory_permission": "0777",
            "file_permission": "0777",
            "filename": "../../modules/database/kubernetes/generated/ananta-local-pg.yaml",
            "id": "c26f11e42f946727ddba119fd1420f22e35c3e27",
            "sensitive_content": null,
            "source": null
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "sensitive_content"
              }
            ]
          ],
          "identity_schema_version": 0,
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.helm_release.cloudnative_pg",
            "module.database.kubernetes_namespace.database",
            "module.database.kubernetes_secret.app_user",
            "module.database.kubernetes_secret.superuser",
            "module.database.random_password.app_user",
            "module.database.random_password.superuser",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.database",
      "mode": "managed",
      "type": "null_resource",
      "name": "cluster",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "3117920071750707515",
            "triggers": {
              "cluster_name": "ananta-local-pg",
              "manifest_sha": "2a40cdcab59302b194623a7634cf6faa",
              "namespace": "database-system"
            }
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.helm_release.cloudnative_pg",
            "module.database.kubernetes_namespace.database",
            "module.database.kubernetes_secret.app_user",
            "module.database.kubernetes_secret.superuser",
            "module.database.local_file.cluster_manifest",
            "module.database.random_password.app_user",
            "module.database.random_password.superuser",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.database",
      "mode": "managed",
      "type": "random_password",
      "name": "app_user",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 3,
          "attributes": {
            "bcrypt_hash": "$2a$10$AN/iTCCgodiG4Zdb8WaeRuAcGM0PjTRx7rMlhOe3dV44y4jW85Oyq",
            "id": "none",
            "keepers": null,
            "length": 24,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": "!#$%\u0026*()-_=+[]{}:?",
            "result": "k6M0XUo9R45h0mMJW_L]P(a0",
            "special": true,
            "upper": true
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "bcrypt_hash"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "result"
              }
            ]
          ],
          "identity_schema_version": 0,
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.database",
      "mode": "managed",
      "type": "random_password",
      "name": "superuser",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 3,
          "attributes": {
            "bcrypt_hash": "$2a$10$0UeuJ7dv2sq2rS9ohf401OmQp6GngKTZDggHX.AplCG4W4lNcqWM2",
            "id": "none",
            "keepers": null,
            "length": 24,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": "!#$%\u0026*()-_=+[]{}:?",
            "result": "d#z-)(B+cXteY=}$AlS:34D%",
            "special": true,
            "upper": true
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "bcrypt_hash"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "result"
              }
            ]
          ],
          "identity_schema_version": 0,
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.keycloak",
      "mode": "managed",
      "type": "kubernetes_config_map",
      "name": "keycloak",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "binary_data": null,
            "data": {
              "KC_DB": "postgres",
              "KC_DB_URL": "jdbc:postgresql://ananta-local-pg-rw.database-system.svc.cluster.local:5432/keycloak",
              "KC_DB_USERNAME": "keycloak",
              "KC_HEALTH_ENABLED": "true",
              "KC_HOSTNAME_STRICT": "false",
              "KC_HTTP_ENABLED": "true",
              "KC_METRICS_ENABLED": "true",
              "KC_PROXY": "edge",
              "KEYCLOAK_ADMIN": "admin"
            },
            "id": "auth-system/ananta-keycloak-config",
            "immutable": false,
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "auth",
                  "app.kubernetes.io/instance": "ananta-keycloak",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "keycloak",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "ananta-keycloak-config",
                "namespace": "auth-system",
                "resource_version": "26267",
                "uid": "920e92d1-5303-49c4-8787-13da01d82ca7"
              }
            ]
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "ConfigMap",
            "name": "ananta-keycloak-config",
            "namespace": "auth-system"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.helm_release.cloudnative_pg",
            "module.database.kubernetes_namespace.database",
            "module.database.kubernetes_secret.app_user",
            "module.database.kubernetes_secret.superuser",
            "module.database.kubernetes_service.database",
            "module.database.local_file.cluster_manifest",
            "module.database.null_resource.cluster",
            "module.database.random_password.app_user",
            "module.database.random_password.superuser",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.keycloak",
      "mode": "managed",
      "type": "kubernetes_secret",
      "name": "keycloak",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "binary_data": null,
            "binary_data_wo": null,
            "binary_data_wo_revision": null,
            "data": {
              "KC_DB_PASSWORD": "8*mU_m%[?uBX!)}a1*TN?Y!f",
              "KEYCLOAK_ADMIN_PASSWORD": "t)ZgVdZd8Vy91pvmZf\u0026#0Cl\u0026"
            },
            "data_wo": null,
            "data_wo_revision": null,
            "id": "auth-system/ananta-keycloak-secrets",
            "immutable": false,
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "auth",
                  "app.kubernetes.io/instance": "ananta-keycloak",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "keycloak",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "ananta-keycloak-secrets",
                "namespace": "auth-system",
                "resource_version": "26283",
                "uid": "118b5f36-049c-4128-894e-29af0ca91f31"
              }
            ],
            "timeouts": null,
            "type": "Opaque",
            "wait_for_service_account_token": true
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "binary_data"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "data"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "data"
              },
              {
                "type": "index",
                "value": {
                  "value": "KC_DB_PASSWORD",
                  "type": "string"
                }
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "data"
              },
              {
                "type": "index",
                "value": {
                  "value": "KEYCLOAK_ADMIN_PASSWORD",
                  "type": "string"
                }
              }
            ]
          ],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Secret",
            "name": "ananta-keycloak-secrets",
            "namespace": "auth-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMH19",
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.helm_release.cloudnative_pg",
            "module.database.kubernetes_namespace.database",
            "module.database.kubernetes_secret.app_user",
            "module.database.kubernetes_secret.superuser",
            "module.database.kubernetes_service.database",
            "module.database.local_file.cluster_manifest",
            "module.database.null_resource.cluster",
            "module.database.random_password.app_user",
            "module.database.random_password.superuser",
            "module.keycloak.random_password.admin_password",
            "module.keycloak.random_password.db_password",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.keycloak",
      "mode": "managed",
      "type": "kubernetes_service",
      "name": "keycloak",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "id": "auth-system/keycloak",
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "auth",
                  "app.kubernetes.io/instance": "ananta-keycloak",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "keycloak",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "keycloak",
                "namespace": "auth-system",
                "resource_version": "26272",
                "uid": "8ba33888-07b3-42d1-b7fd-5328ef62debc"
              }
            ],
            "spec": [
              {
                "allocate_load_balancer_node_ports": true,
                "cluster_ip": "10.43.171.67",
                "cluster_ips": [
                  "10.43.171.67"
                ],
                "external_ips": null,
                "external_name": "",
                "external_traffic_policy": "",
                "health_check_node_port": 0,
                "internal_traffic_policy": "Cluster",
                "ip_families": [
                  "IPv4"
                ],
                "ip_family_policy": "SingleStack",
                "load_balancer_class": "",
                "load_balancer_ip": "",
                "load_balancer_source_ranges": null,
                "port": [
                  {
                    "app_protocol": "",
                    "name": "http",
                    "node_port": 0,
                    "port": 8080,
                    "protocol": "TCP",
                    "target_port": "8080"
                  }
                ],
                "publish_not_ready_addresses": false,
                "selector": {
                  "app.kubernetes.io/instance": "ananta-keycloak",
                  "app.kubernetes.io/name": "keycloak"
                },
                "session_affinity": "None",
                "session_affinity_config": [],
                "type": "ClusterIP"
              }
            ],
            "status": [
              {
                "load_balancer": [
                  {
                    "ingress": []
                  }
                ]
              }
            ],
            "timeouts": null,
            "wait_for_load_balancer": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Service",
            "name": "keycloak",
            "namespace": "auth-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.helm_release.cloudnative_pg",
            "module.database.kubernetes_namespace.database",
            "module.database.kubernetes_secret.app_user",
            "module.database.kubernetes_secret.superuser",
            "module.database.kubernetes_service.database",
            "module.database.local_file.cluster_manifest",
            "module.database.null_resource.cluster",
            "module.database.random_password.app_user",
            "module.database.random_password.superuser",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.keycloak",
      "mode": "managed",
      "type": "kubernetes_service_account",
      "name": "keycloak",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": []
    },
    {
      "module": "module.keycloak",
      "mode": "managed",
      "type": "random_password",
      "name": "admin_password",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 3,
          "attributes": {
            "bcrypt_hash": "$2a$10$z1PMrUj9.e2cRhExkue6ZOLuxrzBFk9Ni2NUdfDnucIRaRrcyoCTK",
            "id": "none",
            "keepers": null,
            "length": 24,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": "!#$%\u0026*()-_=+[]{}:?",
            "result": "t)ZgVdZd8Vy91pvmZf\u0026#0Cl\u0026",
            "special": true,
            "upper": true
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "bcrypt_hash"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "result"
              }
            ]
          ],
          "identity_schema_version": 0,
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.helm_release.cloudnative_pg",
            "module.database.kubernetes_namespace.database",
            "module.database.kubernetes_secret.app_user",
            "module.database.kubernetes_secret.superuser",
            "module.database.kubernetes_service.database",
            "module.database.local_file.cluster_manifest",
            "module.database.null_resource.cluster",
            "module.database.random_password.app_user",
            "module.database.random_password.superuser",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.keycloak",
      "mode": "managed",
      "type": "random_password",
      "name": "db_password",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 3,
          "attributes": {
            "bcrypt_hash": "$2a$10$pn/sG3W.nr2U2hyii/CSjOqk1BPD1PGV0XYfujfSxHn1mWJ5aW03u",
            "id": "none",
            "keepers": null,
            "length": 24,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": "!#$%\u0026*()-_=+[]{}:?",
            "result": "8*mU_m%[?uBX!)}a1*TN?Y!f",
            "special": true,
            "upper": true
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "bcrypt_hash"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "result"
              }
            ]
          ],
          "identity_schema_version": 0,
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.helm_release.cloudnative_pg",
            "module.database.kubernetes_namespace.database",
            "module.database.kubernetes_secret.app_user",
            "module.database.kubernetes_secret.superuser",
            "module.database.kubernetes_service.database",
            "module.database.local_file.cluster_manifest",
            "module.database.null_resource.cluster",
            "module.database.random_password.app_user",
            "module.database.random_password.superuser",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.temporal",
      "mode": "managed",
      "type": "kubernetes_config_map",
      "name": "temporal",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "binary_data": null,
            "data": {
              "DB": "postgres12",
              "DB_PORT": "5432",
              "LOG_LEVEL": "info",
              "POSTGRES_SEEDS": "ananta-local-pg-rw.database-system.svc.cluster.local",
              "POSTGRES_USER": "temporal"
            },
            "id": "temporal-system/ananta-temporal-config",
            "immutable": false,
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "workflow",
                  "app.kubernetes.io/instance": "ananta-temporal",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "temporal",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "ananta-temporal-config",
                "namespace": "temporal-system",
                "resource_version": "26268",
                "uid": "ff95fa12-b70f-4315-b0e7-8240825ca375"
              }
            ]
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "ConfigMap",
            "name": "ananta-temporal-config",
            "namespace": "temporal-system"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.helm_release.cloudnative_pg",
            "module.database.kubernetes_namespace.database",
            "module.database.kubernetes_secret.app_user",
            "module.database.kubernetes_secret.superuser",
            "module.database.kubernetes_service.database",
            "module.database.local_file.cluster_manifest",
            "module.database.null_resource.cluster",
            "module.database.random_password.app_user",
            "module.database.random_password.superuser",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.temporal",
      "mode": "managed",
      "type": "kubernetes_deployment",
      "name": "temporal",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "status": "tainted",
          "schema_version": 1,
          "attributes": {
            "id": "temporal-system/temporal",
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "workflow",
                  "app.kubernetes.io/instance": "ananta-temporal",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "temporal",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "temporal",
                "namespace": "temporal-system",
                "resource_version": "",
                "uid": ""
              }
            ],
            "spec": [
              {
                "min_ready_seconds": 0,
                "paused": false,
                "progress_deadline_seconds": 600,
                "replicas": "1",
                "revision_history_limit": 10,
                "selector": [
                  {
                    "match_expressions": [],
                    "match_labels": {
                      "app.kubernetes.io/instance": "ananta-temporal",
                      "app.kubernetes.io/name": "temporal"
                    }
                  }
                ],
                "strategy": [],
                "template": [
                  {
                    "metadata": [
                      {
                        "annotations": null,
                        "generate_name": "",
                        "generation": 0,
                        "labels": {
                          "app.kubernetes.io/component": "workflow",
                          "app.kubernetes.io/instance": "ananta-temporal",
                          "app.kubernetes.io/managed-by": "terraform",
                          "app.kubernetes.io/name": "temporal",
                          "app.kubernetes.io/part-of": "ananta-platform",
                          "environment": "local"
                        },
                        "name": "",
                        "namespace": "",
                        "resource_version": "",
                        "uid": ""
                      }
                    ],
                    "spec": [
                      {
                        "active_deadline_seconds": 0,
                        "affinity": [],
                        "automount_service_account_token": true,
                        "container": [
                          {
                            "args": null,
                            "command": null,
                            "env": [],
                            "env_from": [
                              {
                                "config_map_ref": [
                                  {
                                    "name": "ananta-temporal-config",
                                    "optional": false
                                  }
                                ],
                                "prefix": "",
                                "secret_ref": []
                              },
                              {
                                "config_map_ref": [],
                                "prefix": "",
                                "secret_ref": [
                                  {
                                    "name": "ananta-temporal-secrets",
                                    "optional": false
                                  }
                                ]
                              }
                            ],
                            "image": "temporalio/auto-setup:1.24.2",
                            "image_pull_policy": "",
                            "lifecycle": [],
                            "liveness_probe": [
                              {
                                "exec": [],
                                "failure_threshold": 3,
                                "grpc": [],
                                "http_get": [],
                                "initial_delay_seconds": 60,
                                "period_seconds": 30,
                                "success_threshold": 1,
                                "tcp_socket": [
                                  {
                                    "port": "7233"
                                  }
                                ],
                                "timeout_seconds": 1
                              }
                            ],
                            "name": "temporal",
                            "port": [
                              {
                                "container_port": 7233,
                                "host_ip": "",
                                "host_port": 0,
                                "name": "grpc",
                                "protocol": "TCP"
                              }
                            ],
                            "readiness_probe": [
                              {
                                "exec": [],
                                "failure_threshold": 3,
                                "grpc": [],
                                "http_get": [],
                                "initial_delay_seconds": 10,
                                "period_seconds": 10,
                                "success_threshold": 1,
                                "tcp_socket": [
                                  {
                                    "port": "7233"
                                  }
                                ],
                                "timeout_seconds": 1
                              }
                            ],
                            "resources": [
                              {
                                "limits": {
                                  "cpu": "1000m",
                                  "memory": "1Gi"
                                },
                                "requests": {
                                  "cpu": "250m",
                                  "memory": "512Mi"
                                }
                              }
                            ],
                            "restart_policy": "",
                            "security_context": [],
                            "startup_probe": [
                              {
                                "exec": [],
                                "failure_threshold": 30,
                                "grpc": [],
                                "http_get": [],
                                "initial_delay_seconds": 30,
                                "period_seconds": 10,
                                "success_threshold": 1,
                                "tcp_socket": [
                                  {
                                    "port": "7233"
                                  }
                                ],
                                "timeout_seconds": 1
                              }
                            ],
                            "stdin": false,
                            "stdin_once": false,
                            "termination_message_path": "/dev/termination-log",
                            "termination_message_policy": "",
                            "tty": false,
                            "volume_device": [],
                            "volume_mount": [],
                            "working_dir": ""
                          }
                        ],
                        "dns_config": [],
                        "dns_policy": "ClusterFirst",
                        "enable_service_links": true,
                        "host_aliases": [],
                        "host_ipc": false,
                        "host_network": false,
                        "host_pid": false,
                        "hostname": "",
                        "image_pull_secrets": [],
                        "init_container": [],
                        "node_name": "",
                        "node_selector": null,
                        "os": [],
                        "priority_class_name": "",
                        "readiness_gate": [],
                        "restart_policy": "Always",
                        "runtime_class_name": "",
                        "scheduler_name": "",
                        "security_context": [],
                        "service_account_name": "",
                        "share_process_namespace": false,
                        "subdomain": "",
                        "termination_grace_period_seconds": 30,
                        "toleration": [],
                        "topology_spread_constraint": [],
                        "volume": []
                      }
                    ]
                  }
                ]
              }
            ],
            "timeouts": null,
            "wait_for_rollout": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": null,
            "kind": null,
            "name": null,
            "namespace": null
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.helm_release.cloudnative_pg",
            "module.database.kubernetes_namespace.database",
            "module.database.kubernetes_secret.app_user",
            "module.database.kubernetes_secret.superuser",
            "module.database.kubernetes_service.database",
            "module.database.local_file.cluster_manifest",
            "module.database.null_resource.cluster",
            "module.database.random_password.app_user",
            "module.database.random_password.superuser",
            "module.temporal.kubernetes_config_map.temporal",
            "module.temporal.kubernetes_secret.temporal",
            "module.temporal.kubernetes_service_account.temporal",
            "module.temporal.random_password.db_password",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.temporal",
      "mode": "managed",
      "type": "kubernetes_secret",
      "name": "temporal",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "binary_data": null,
            "binary_data_wo": null,
            "binary_data_wo_revision": null,
            "data": {
              "POSTGRES_PWD": "OKE3SoDd6EpC9m0VYzyMMJic"
            },
            "data_wo": null,
            "data_wo_revision": null,
            "id": "temporal-system/ananta-temporal-secrets",
            "immutable": false,
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "workflow",
                  "app.kubernetes.io/instance": "ananta-temporal",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "temporal",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "ananta-temporal-secrets",
                "namespace": "temporal-system",
                "resource_version": "26284",
                "uid": "b2495fa3-3501-4c1c-802f-5700588d1d02"
              }
            ],
            "timeouts": null,
            "type": "Opaque",
            "wait_for_service_account_token": true
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "binary_data"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "data"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "data"
              },
              {
                "type": "index",
                "value": {
                  "value": "POSTGRES_PWD",
                  "type": "string"
                }
              }
            ]
          ],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Secret",
            "name": "ananta-temporal-secrets",
            "namespace": "temporal-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMH19",
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.helm_release.cloudnative_pg",
            "module.database.kubernetes_namespace.database",
            "module.database.kubernetes_secret.app_user",
            "module.database.kubernetes_secret.superuser",
            "module.database.kubernetes_service.database",
            "module.database.local_file.cluster_manifest",
            "module.database.null_resource.cluster",
            "module.database.random_password.app_user",
            "module.database.random_password.superuser",
            "module.temporal.random_password.db_password",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.temporal",
      "mode": "managed",
      "type": "kubernetes_service",
      "name": "temporal",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "id": "temporal-system/temporal",
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "workflow",
                  "app.kubernetes.io/instance": "ananta-temporal",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "temporal",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "temporal",
                "namespace": "temporal-system",
                "resource_version": "26274",
                "uid": "254328d2-bbfc-4cad-92cd-d922abb57deb"
              }
            ],
            "spec": [
              {
                "allocate_load_balancer_node_ports": true,
                "cluster_ip": "10.43.136.79",
                "cluster_ips": [
                  "10.43.136.79"
                ],
                "external_ips": null,
                "external_name": "",
                "external_traffic_policy": "",
                "health_check_node_port": 0,
                "internal_traffic_policy": "Cluster",
                "ip_families": [
                  "IPv4"
                ],
                "ip_family_policy": "SingleStack",
                "load_balancer_class": "",
                "load_balancer_ip": "",
                "load_balancer_source_ranges": null,
                "port": [
                  {
                    "app_protocol": "",
                    "name": "grpc",
                    "node_port": 0,
                    "port": 7233,
                    "protocol": "TCP",
                    "target_port": "7233"
                  }
                ],
                "publish_not_ready_addresses": false,
                "selector": {
                  "app.kubernetes.io/instance": "ananta-temporal",
                  "app.kubernetes.io/name": "temporal"
                },
                "session_affinity": "None",
                "session_affinity_config": [],
                "type": "ClusterIP"
              }
            ],
            "status": [
              {
                "load_balancer": [
                  {
                    "ingress": []
                  }
                ]
              }
            ],
            "timeouts": null,
            "wait_for_load_balancer": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Service",
            "name": "temporal",
            "namespace": "temporal-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.helm_release.cloudnative_pg",
            "module.database.kubernetes_namespace.database",
            "module.database.kubernetes_secret.app_user",
            "module.database.kubernetes_secret.superuser",
            "module.database.kubernetes_service.database",
            "module.database.local_file.cluster_manifest",
            "module.database.null_resource.cluster",
            "module.database.random_password.app_user",
            "module.database.random_password.superuser",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.temporal",
      "mode": "managed",
      "type": "kubernetes_service",
      "name": "temporal_ui",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 1,
          "attributes": {
            "id": "temporal-system/temporal-ui",
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "workflow-ui",
                  "app.kubernetes.io/instance": "ananta-temporal-ui",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "temporal-ui",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "temporal-ui",
                "namespace": "temporal-system",
                "resource_version": "26270",
                "uid": "773d342d-1f26-4102-8baf-1476e1b3cc0a"
              }
            ],
            "spec": [
              {
                "allocate_load_balancer_node_ports": true,
                "cluster_ip": "10.43.162.239",
                "cluster_ips": [
                  "10.43.162.239"
                ],
                "external_ips": null,
                "external_name": "",
                "external_traffic_policy": "",
                "health_check_node_port": 0,
                "internal_traffic_policy": "Cluster",
                "ip_families": [
                  "IPv4"
                ],
                "ip_family_policy": "SingleStack",
                "load_balancer_class": "",
                "load_balancer_ip": "",
                "load_balancer_source_ranges": null,
                "port": [
                  {
                    "app_protocol": "",
                    "name": "http",
                    "node_port": 0,
                    "port": 8080,
                    "protocol": "TCP",
                    "target_port": "8080"
                  }
                ],
                "publish_not_ready_addresses": false,
                "selector": {
                  "app.kubernetes.io/instance": "ananta-temporal-ui",
                  "app.kubernetes.io/name": "temporal-ui"
                },
                "session_affinity": "None",
                "session_affinity_config": [],
                "type": "ClusterIP"
              }
            ],
            "status": [
              {
                "load_balancer": [
                  {
                    "ingress": []
                  }
                ]
              }
            ],
            "timeouts": null,
            "wait_for_load_balancer": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "Service",
            "name": "temporal-ui",
            "namespace": "temporal-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.helm_release.cloudnative_pg",
            "module.database.kubernetes_namespace.database",
            "module.database.kubernetes_secret.app_user",
            "module.database.kubernetes_secret.superuser",
            "module.database.kubernetes_service.database",
            "module.database.local_file.cluster_manifest",
            "module.database.null_resource.cluster",
            "module.database.random_password.app_user",
            "module.database.random_password.superuser",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.temporal",
      "mode": "managed",
      "type": "kubernetes_service_account",
      "name": "temporal",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": []
    },
    {
      "module": "module.temporal",
      "mode": "managed",
      "type": "random_password",
      "name": "db_password",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 3,
          "attributes": {
            "bcrypt_hash": "$2a$10$M4Ex/EqcHV.5bPkq0xjXsu.XVIIUke.sh8XUjvmwGxA6.21rrthMa",
            "id": "none",
            "keepers": null,
            "length": 24,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": null,
            "result": "OKE3SoDd6EpC9m0VYzyMMJic",
            "special": false,
            "upper": true
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "bcrypt_hash"
              }
            ],
            [
              {
                "type": "get_attr",
                "value": "result"
              }
            ]
          ],
          "identity_schema_version": 0,
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.database.helm_release.cloudnative_pg",
            "module.database.kubernetes_namespace.database",
            "module.database.kubernetes_secret.app_user",
            "module.database.kubernetes_secret.superuser",
            "module.database.kubernetes_service.database",
            "module.database.local_file.cluster_manifest",
            "module.database.null_resource.cluster",
            "module.database.random_password.app_user",
            "module.database.random_password.superuser",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_config_map.vault_agent_config",
            "module.vault.kubernetes_job.vault_init",
            "module.vault.kubernetes_job.vault_seed"
          ]
        }
      ]
    },
    {
      "module": "module.vault",
      "mode": "managed",
      "type": "helm_release",
      "name": "vault",
      "provider": "provider[\"registry.terraform.io/hashicorp/helm\"]",
      "instances": [
        {
          "schema_version": 2,
          "attributes": {
            "atomic": false,
            "chart": "vault",
            "cleanup_on_fail": false,
            "create_namespace": false,
            "dependency_update": false,
            "description": null,
            "devel": null,
            "disable_crd_hooks": false,
            "disable_openapi_validation": false,
            "disable_webhooks": false,
            "force_update": false,
            "id": "ananta-vault",
            "keyring": null,
            "lint": false,
            "manifest": null,
            "max_history": 0,
            "metadata": {
              "app_version": "1.15.2",
              "chart": "vault",
              "first_deployed": 1767822326,
              "last_deployed": 1767822326,
              "name": "ananta-vault",
              "namespace": "vault-system",
              "notes": "\nThank you for installing HashiCorp Vault!\n\nNow that you have deployed Vault, you should look over the docs on using\nVault with Kubernetes available here:\n\nhttps://developer.hashicorp.com/vault/docs\n\n\nYour release is named ananta-vault. To learn more about the release, try:\n\n  $ helm status ananta-vault\n  $ helm get manifest ananta-vault\n\n",
              "revision": 1,
              "values": "{\"csi\":{\"enabled\":false},\"global\":{\"enabled\":true},\"injector\":{\"enabled\":true,\"resources\":{\"limits\":{\"cpu\":\"100m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"50m\",\"memory\":\"64Mi\"}}},\"server\":{\"dataStorage\":null,\"dev\":{\"devRootToken\":\"root\",\"enabled\":true},\"livenessProbe\":{\"enabled\":true,\"initialDelaySeconds\":60,\"path\":\"/v1/sys/health?standbyok=true\"},\"readinessProbe\":{\"enabled\":true,\"path\":\"/v1/sys/health?standbyok=true\"},\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"256Mi\"}},\"service\":{\"enabled\":true,\"port\":8200,\"type\":\"ClusterIP\"},\"standalone\":{\"config\":null,\"enabled\":false}},\"ui\":{\"enabled\":true,\"serviceType\":\"ClusterIP\"}}",
              "version": "0.27.0"
            },
            "name": "ananta-vault",
            "namespace": "vault-system",
            "pass_credentials": false,
            "postrender": null,
            "recreate_pods": false,
            "render_subchart_notes": true,
            "replace": false,
            "repository": "https://helm.releases.hashicorp.com",
            "repository_ca_file": null,
            "repository_cert_file": null,
            "repository_key_file": null,
            "repository_password": null,
            "repository_username": null,
            "reset_values": false,
            "resources": null,
            "reuse_values": false,
            "set": null,
            "set_list": null,
            "set_sensitive": null,
            "set_wo": null,
            "set_wo_revision": null,
            "skip_crds": false,
            "status": "deployed",
            "take_ownership": false,
            "timeout": 300,
            "timeouts": null,
            "upgrade_install": false,
            "values": [
              "\"csi\":\n  \"enabled\": false\n\"global\":\n  \"enabled\": true\n\"injector\":\n  \"enabled\": true\n  \"resources\":\n    \"limits\":\n      \"cpu\": \"100m\"\n      \"memory\": \"128Mi\"\n    \"requests\":\n      \"cpu\": \"50m\"\n      \"memory\": \"64Mi\"\n\"server\":\n  \"dataStorage\": null\n  \"dev\":\n    \"devRootToken\": \"root\"\n    \"enabled\": true\n  \"livenessProbe\":\n    \"enabled\": true\n    \"initialDelaySeconds\": 60\n    \"path\": \"/v1/sys/health?standbyok=true\"\n  \"readinessProbe\":\n    \"enabled\": true\n    \"path\": \"/v1/sys/health?standbyok=true\"\n  \"resources\":\n    \"limits\":\n      \"cpu\": \"500m\"\n      \"memory\": \"512Mi\"\n    \"requests\":\n      \"cpu\": \"100m\"\n      \"memory\": \"256Mi\"\n  \"service\":\n    \"enabled\": true\n    \"port\": 8200\n    \"type\": \"ClusterIP\"\n  \"standalone\":\n    \"config\": null\n    \"enabled\": false\n\"ui\":\n  \"enabled\": true\n  \"serviceType\": \"ClusterIP\"\n"
            ],
            "verify": false,
            "version": "0.27.0",
            "wait": true,
            "wait_for_jobs": false
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "repository_password"
              }
            ]
          ],
          "identity_schema_version": 0,
          "identity": {
            "namespace": "vault-system",
            "release_name": "ananta-vault"
          },
          "dependencies": [
            "kubernetes_namespace.namespaces"
          ]
        }
      ]
    },
    {
      "module": "module.vault",
      "mode": "managed",
      "type": "kubernetes_config_map",
      "name": "vault_agent_config",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "binary_data": {},
            "data": {
              "database.ctmpl": "{{- with secret \"secret/data/database/ananta\" -}}\nDATABASE_HOST={{ .Data.data.host }}\nDATABASE_PORT={{ .Data.data.port }}\nDATABASE_NAME={{ .Data.data.database }}\nDATABASE_USERNAME={{ .Data.data.username }}\nDATABASE_PASSWORD={{ .Data.data.password }}\n{{- end -}}\n",
              "keycloak.ctmpl": "{{- with secret \"secret/data/auth/keycloak\" -}}\nKEYCLOAK_ADMIN={{ .Data.data.admin_username }}\nKEYCLOAK_ADMIN_PASSWORD={{ .Data.data.admin_password }}\nKC_DB_PASSWORD={{ .Data.data.db_password }}\n{{- end -}}\n",
              "redis.ctmpl": "{{- with secret \"secret/data/cache/redis\" -}}\nREDIS_PASSWORD={{ .Data.data.password }}\n{{- end -}}\n"
            },
            "id": "vault-system/ananta-vault-agent-config",
            "immutable": false,
            "metadata": [
              {
                "annotations": {},
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "secrets",
                  "app.kubernetes.io/instance": "ananta-vault",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "vault",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "ananta-vault-agent-config",
                "namespace": "vault-system",
                "resource_version": "21403",
                "uid": "f86711ae-f8f5-4e4c-98fd-525b375f3dea"
              }
            ]
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "v1",
            "kind": "ConfigMap",
            "name": "ananta-vault-agent-config",
            "namespace": "vault-system"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "kubernetes_namespace.namespaces"
          ]
        }
      ]
    },
    {
      "module": "module.vault",
      "mode": "managed",
      "type": "kubernetes_job",
      "name": "vault_init",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": []
    },
    {
      "module": "module.vault",
      "mode": "managed",
      "type": "kubernetes_job",
      "name": "vault_seed",
      "provider": "provider[\"registry.terraform.io/hashicorp/kubernetes\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 1,
          "attributes": {
            "id": "vault-system/ananta-vault-seed",
            "metadata": [
              {
                "annotations": null,
                "generate_name": "",
                "generation": 0,
                "labels": {
                  "app.kubernetes.io/component": "secrets",
                  "app.kubernetes.io/instance": "ananta-vault",
                  "app.kubernetes.io/managed-by": "terraform",
                  "app.kubernetes.io/name": "vault",
                  "app.kubernetes.io/part-of": "ananta-platform",
                  "environment": "local"
                },
                "name": "ananta-vault-seed",
                "namespace": "vault-system",
                "resource_version": "",
                "uid": ""
              }
            ],
            "spec": [
              {
                "active_deadline_seconds": 0,
                "backoff_limit": 5,
                "backoff_limit_per_index": 0,
                "completion_mode": "",
                "completions": 1,
                "manual_selector": false,
                "max_failed_indexes": 0,
                "parallelism": 1,
                "pod_failure_policy": [],
                "selector": [],
                "template": [
                  {
                    "metadata": [
                      {
                        "annotations": null,
                        "generate_name": "",
                        "generation": 0,
                        "labels": {
                          "app.kubernetes.io/component": "secrets",
                          "app.kubernetes.io/instance": "ananta-vault",
                          "app.kubernetes.io/managed-by": "terraform",
                          "app.kubernetes.io/name": "vault",
                          "app.kubernetes.io/part-of": "ananta-platform",
                          "environment": "local"
                        },
                        "name": "",
                        "resource_version": "",
                        "uid": ""
                      }
                    ],
                    "spec": [
                      {
                        "active_deadline_seconds": 0,
                        "affinity": [],
                        "automount_service_account_token": true,
                        "container": [
                          {
                            "args": [
                              "set -e\n\nVAULT_ADDR=\"http://ananta-vault:8200\"\nexport VAULT_ADDR\n\n# Get root token\nif [ \"true\" = \"true\" ]; then\n  VAULT_TOKEN=\"root\"\nelse\n  # Wait for init job to complete\n  sleep 30\n  VAULT_TOKEN=$(kubectl get secret ananta-vault-keys -n vault-system -o jsonpath='{.data.root-token}' | base64 -d)\nfi\nexport VAULT_TOKEN\n\n# Enable KV secrets engine\nvault secrets enable -path=secret -version=2 kv 2\u003e/dev/null || true\n\n# Enable Kubernetes auth\nvault auth enable kubernetes 2\u003e/dev/null || true\n\n# Configure Kubernetes auth\nvault write auth/kubernetes/config \\\n  kubernetes_host=\"https://kubernetes.default.svc\" \\\n  kubernetes_ca_cert=@/var/run/secrets/kubernetes.io/serviceaccount/ca.crt \\\n  token_reviewer_jwt=@/var/run/secrets/kubernetes.io/serviceaccount/token\n\n# Generate and store database passwords\nDB_POSTGRES_PASS=$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 32 | head -n 1)\nDB_KEYCLOAK_PASS=$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 32 | head -n 1)\nDB_TEMPORAL_PASS=$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 32 | head -n 1)\nDB_ANANTA_PASS=$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 32 | head -n 1)\n\nvault kv put secret/database/postgres \\\n  username=postgres \\\n  password=$DB_POSTGRES_PASS\n\nvault kv put secret/database/keycloak \\\n  username=keycloak \\\n  password=$DB_KEYCLOAK_PASS\n\nvault kv put secret/database/temporal \\\n  username=temporal \\\n  password=$DB_TEMPORAL_PASS\n\nvault kv put secret/database/ananta \\\n  username=ananta_app \\\n  password=$DB_ANANTA_PASS\n\n# Redis password\nREDIS_PASS=$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 32 | head -n 1)\nvault kv put secret/cache/redis \\\n  password=$REDIS_PASS\n\n# Keycloak admin credentials\nKC_ADMIN_PASS=$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 32 | head -n 1)\nvault kv put secret/auth/keycloak \\\n  admin_username=admin \\\n  admin_password=$KC_ADMIN_PASS \\\n  db_password=$DB_KEYCLOAK_PASS\n\n# Control plane secrets\nJWT_SECRET=$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 64 | head -n 1)\nvault kv put secret/control-plane/jwt \\\n  secret=$JWT_SECRET\n\nvault kv put secret/control-plane/database \\\n  host=postgresql.database-system.svc.cluster.local \\\n  port=5432 \\\n  database=ananta \\\n  username=ananta_app \\\n  password=$DB_ANANTA_PASS\n\n# Create policies for each service\nvault policy write database-read - \u003c\u003cEOF\npath \"secret/data/database/*\" {\n  capabilities = [\"read\"]\n}\nEOF\n\nvault policy write control-plane - \u003c\u003cEOF\npath \"secret/data/control-plane/*\" {\n  capabilities = [\"read\"]\n}\npath \"secret/data/database/ananta\" {\n  capabilities = [\"read\"]\n}\npath \"secret/data/cache/redis\" {\n  capabilities = [\"read\"]\n}\npath \"secret/data/auth/keycloak\" {\n  capabilities = [\"read\"]\n}\nEOF\n\nvault policy write keycloak - \u003c\u003cEOF\npath \"secret/data/auth/keycloak\" {\n  capabilities = [\"read\"]\n}\npath \"secret/data/database/keycloak\" {\n  capabilities = [\"read\"]\n}\nEOF\n\nvault policy write temporal - \u003c\u003cEOF\npath \"secret/data/temporal/*\" {\n  capabilities = [\"read\"]\n}\npath \"secret/data/database/temporal\" {\n  capabilities = [\"read\"]\n}\nEOF\n\n# Create Kubernetes auth roles\nvault write auth/kubernetes/role/control-plane \\\n  bound_service_account_names=* \\\n  bound_service_account_namespaces=control-plane \\\n  policies=control-plane \\\n  ttl=1h\n\nvault write auth/kubernetes/role/keycloak \\\n  bound_service_account_names=* \\\n  bound_service_account_namespaces=auth-system \\\n  policies=keycloak \\\n  ttl=1h\n\nvault write auth/kubernetes/role/temporal \\\n  bound_service_account_names=* \\\n  bound_service_account_namespaces=temporal-system \\\n  policies=temporal \\\n  ttl=1h\n\nvault write auth/kubernetes/role/database \\\n  bound_service_account_names=* \\\n  bound_service_account_namespaces=database-system \\\n  policies=database-read \\\n  ttl=1h\n\necho \"Vault secrets seeded successfully!\"\n"
                            ],
                            "command": [
                              "/bin/sh",
                              "-c"
                            ],
                            "env": [
                              {
                                "name": "VAULT_ADDR",
                                "value": "http://ananta-vault:8200",
                                "value_from": []
                              }
                            ],
                            "env_from": [],
                            "image": "hashicorp/vault:1.15.4",
                            "image_pull_policy": "",
                            "lifecycle": [],
                            "liveness_probe": [],
                            "name": "vault-seed",
                            "port": [],
                            "readiness_probe": [],
                            "resources": [],
                            "restart_policy": "",
                            "security_context": [],
                            "startup_probe": [],
                            "stdin": false,
                            "stdin_once": false,
                            "termination_message_path": "/dev/termination-log",
                            "termination_message_policy": "",
                            "tty": false,
                            "volume_device": [],
                            "volume_mount": [],
                            "working_dir": ""
                          }
                        ],
                        "dns_config": [],
                        "dns_policy": "ClusterFirst",
                        "enable_service_links": true,
                        "host_aliases": [],
                        "host_ipc": false,
                        "host_network": false,
                        "host_pid": false,
                        "hostname": "",
                        "image_pull_secrets": [],
                        "init_container": [],
                        "node_name": "",
                        "node_selector": null,
                        "os": [],
                        "priority_class_name": "",
                        "readiness_gate": [],
                        "restart_policy": "OnFailure",
                        "runtime_class_name": "",
                        "scheduler_name": "",
                        "security_context": [],
                        "service_account_name": "",
                        "share_process_namespace": false,
                        "subdomain": "",
                        "termination_grace_period_seconds": 30,
                        "toleration": [],
                        "topology_spread_constraint": [],
                        "volume": []
                      }
                    ]
                  }
                ],
                "ttl_seconds_after_finished": "600"
              }
            ],
            "timeouts": null,
            "wait_for_completion": true
          },
          "sensitive_attributes": [],
          "identity_schema_version": 1,
          "identity": {
            "api_version": "batch/v1",
            "kind": "Job",
            "name": "ananta-vault-seed",
            "namespace": "vault-system"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMCwiZGVsZXRlIjo2MDAwMDAwMDAwMCwidXBkYXRlIjo2MDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "kubernetes_namespace.namespaces",
            "module.vault.helm_release.vault",
            "module.vault.kubernetes_job.vault_init"
          ]
        }
      ]
    }
  ],
  "check_results": null
}
